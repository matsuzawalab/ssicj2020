<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="社会情報学部" />
  <title>コンピューティング実習第3部（HTML+Javascript編）</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="cj.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">コンピューティング実習第3部（HTML+Javascript編）</h1>
<p class="author">社会情報学部</p>
<p class="date">version 0.1</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#ボタンとjavascriptの連携"><span class="toc-section-number">1</span> ボタンとJavascriptの連携</a></li>
<li><a href="#テキストフィールドとjavascriptの連携"><span class="toc-section-number">2</span> テキストフィールドとJavaScriptの連携</a></li>
<li><a href="#javascriptによるhtmlの生成"><span class="toc-section-number">3</span> JavascriptによるHTMLの生成</a></li>
<li><a href="#html生成-応用編"><span class="toc-section-number">4</span> HTML生成　応用編</a></li>
<li><a href="#ローカル変数とグローバル変数"><span class="toc-section-number">5</span> ローカル変数とグローバル変数</a></li>
<li><a href="#canvas入門"><span class="toc-section-number">6</span> canvas入門</a></li>
<li><a href="#canvas-応用編"><span class="toc-section-number">7</span> canvas 応用編</a></li>
<li><a href="#タイマー"><span class="toc-section-number">8</span> タイマー</a></li>
<li><a href="#タイマーとcanvasを使ったアニメーションの作成"><span class="toc-section-number">9</span> タイマーとcanvasを使ったアニメーションの作成</a></li>
</ul>
</nav>
<script>
    function copycode(idstr){
        document.getSelection().selectAllChildren(document.getElementById(idstr).querySelector('code')); 
        document.execCommand('copy');
    }
</script>
<h1 data-number="1" id="ボタンとjavascriptの連携"><span class="header-section-number">1</span> ボタンとJavascriptの連携</h1>
<p>第３部では初学者用Webページ開発環境（pikeplace - kenya）を使って，HTMLとJavascriptを使い，ブラウザで動くプログラムを作ることを学習します．</p>
<p>本章では，htmlとJavascriptの基本を学びます．</p>
<h2 data-number="1.1" id="ボタンを作る"><span class="header-section-number">1.1</span> ボタンを作る</h2>
<p>htmlを使ってボタンを作るには，buttonタグを使います．</p>
<pre><code>&lt;button&gt;[ボタンのラベル]&lt;/button&gt;</code></pre>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:1-1')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:1-1" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:1-1-1"><a href="#lst:1-1-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:1-1-2"><a href="#lst:1-1-2"></a></span>
<span id="lst:1-1-3"><a href="#lst:1-1-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:1-1-4"><a href="#lst:1-1-4"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:1-1-5"><a href="#lst:1-1-5"></a></span>
<span id="lst:1-1-6"><a href="#lst:1-1-6"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:1-1-7"><a href="#lst:1-1-7"></a>    <span class="kw">&lt;button&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:1-1-8"><a href="#lst:1-1-8"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:1-1-9"><a href="#lst:1-1-9"></a></span>
<span id="lst:1-1-10"><a href="#lst:1-1-10"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/1-1.html" class="myiframe"></iframe>
</div>
<p>まだ，ボタンを押しても何も起こりません．</p>
<h2 data-number="1.2" id="javascriptを埋め込む"><span class="header-section-number">1.2</span> Javascriptを埋め込む</h2>
<p>htmlにJavascriptプログラムを埋め込むには，scriptタグを使います． scriptタグの中にJavascriptのプログラムを書きます．</p>
<pre><code>&lt;html&gt;

&lt;head&gt;
    &lt;script&gt;
        [Javascriptのプログラム]
    &lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;/body&gt;

&lt;/html&gt;</code></pre>
<h2 data-number="1.3" id="ボタンが押されたときにjavascriptプログラムを動かす"><span class="header-section-number">1.3</span> ボタンが押されたときにJavascriptプログラムを動かす</h2>
<p>ボタンが押されたときにJavascriptプログラムを動かすようにするには，buttonタグの属性onclickに関数呼び出しのプログラムを書き，scriptタグの中で定義している関数を呼び出します．</p>
<pre><code>&lt;button onclick=&quot;a()&quot;&gt;A&lt;/button&gt;</code></pre>
<p>scriptタグの中には，これまでタートルグラフィックス編で学習してきたJavascriptの構文が概ね利用できますが， タートルグラフィックスの専用命令で利用できないものもあります．利用できるものとできないものを下記にまとめました．</p>
<ul>
<li>利用できるもの
<ul>
<li>変数</li>
<li>条件分岐（if文）</li>
<li>繰り返し(while文，for文）</li>
<li>関数呼び出し(引数，戻り値)</li>
</ul></li>
<li>利用できないもの
<ul>
<li>タートルの動作に関する命令（createTurtle, fd, rtなど）</li>
<li>print, println命令</li>
<li>random命令</li>
</ul></li>
</ul>
<p>ここで，ボタンが押されたときにHello, world!と表示されるプログラムを作りたいのですが，タートルではないJavascriptでは，print()命令は使えません．代わりにこのプログラムでは，以下の２つの命令でメッセージを表示しています．</p>
<p>window.alert命令は，ダイアログにメッセージを出力します．</p>
<pre><code>window.alert(&quot;メッセージ&quot;)</code></pre>
<p>console.log(“メッセージ”)命令は，コンソールにメッセージを出力します．</p>
<pre><code>console.log(&quot;メッセージ&quot;)</code></pre>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:1-3')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:1-3" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:1-3-1"><a href="#lst:1-3-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:1-3-2"><a href="#lst:1-3-2"></a></span>
<span id="lst:1-3-3"><a href="#lst:1-3-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:1-3-4"><a href="#lst:1-3-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:1-3-5"><a href="#lst:1-3-5"></a>        <span class="kw">function</span> <span class="fu">a</span>() {</span>
<span id="lst:1-3-6"><a href="#lst:1-3-6"></a>            <span class="bu">window</span><span class="op">.</span><span class="fu">alert</span>(<span class="st">&#39;hello, world&#39;</span>)<span class="op">;</span></span>
<span id="lst:1-3-7"><a href="#lst:1-3-7"></a>            <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&#39;こんにちは！&#39;</span>)<span class="op">;</span></span>
<span id="lst:1-3-8"><a href="#lst:1-3-8"></a>        }</span>
<span id="lst:1-3-9"><a href="#lst:1-3-9"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:1-3-10"><a href="#lst:1-3-10"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:1-3-11"><a href="#lst:1-3-11"></a></span>
<span id="lst:1-3-12"><a href="#lst:1-3-12"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:1-3-13"><a href="#lst:1-3-13"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;a()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:1-3-14"><a href="#lst:1-3-14"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:1-3-15"><a href="#lst:1-3-15"></a></span>
<span id="lst:1-3-16"><a href="#lst:1-3-16"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/1-3.html" class="myiframe"></iframe>
</div>
<h3 data-number="1.3.1" id="コンソールを表示する"><span class="header-section-number">1.3.1</span> コンソールを表示する</h3>
<p>console.log()命令で指定したメッセージを表示したり，エラーをみたりするには，ブラウザのコンソール機能を利用します．</p>
コンソールを開くには，
<ul>
<li>
Chromeでは，<a href="https://www.javadrive.jp/javascript/console/index1.html">こちら</a>のサイトが参考になる．
</li>
<li>
Safariでは，<a href="https://www.84kure.com/blog/2014/12/19/safari-javascript%E3%82%B3%E3%83%B3%E3%82%BD%E3%83%BC%E3%83%AB%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B%E3%81%AB%E3%81%AF/">こちら</a>のサイトが参考になる．
</li>
</ul>
<h2 data-number="1.4" id="ボタンを２つ作る"><span class="header-section-number">1.4</span> ボタンを２つ作る</h2>
<p>ボタンを２つ作ることもできます．異なる２つの機能を実現するために，２つの関数を用意して，２つのボタンそれぞれが機能に対応する関数を呼ぶように設計します．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:1-4')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:1-4" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:1-4-1"><a href="#lst:1-4-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:1-4-2"><a href="#lst:1-4-2"></a></span>
<span id="lst:1-4-3"><a href="#lst:1-4-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:1-4-4"><a href="#lst:1-4-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:1-4-5"><a href="#lst:1-4-5"></a>        <span class="kw">function</span> <span class="fu">a</span>() {</span>
<span id="lst:1-4-6"><a href="#lst:1-4-6"></a>            <span class="bu">window</span><span class="op">.</span><span class="fu">alert</span>(<span class="st">&#39;A!&#39;</span>)<span class="op">;</span></span>
<span id="lst:1-4-7"><a href="#lst:1-4-7"></a>        }</span>
<span id="lst:1-4-8"><a href="#lst:1-4-8"></a>        <span class="kw">function</span> <span class="fu">b</span>() {</span>
<span id="lst:1-4-9"><a href="#lst:1-4-9"></a>            <span class="bu">window</span><span class="op">.</span><span class="fu">alert</span>(<span class="st">&#39;B!&#39;</span>)<span class="op">;</span></span>
<span id="lst:1-4-10"><a href="#lst:1-4-10"></a>        }            </span>
<span id="lst:1-4-11"><a href="#lst:1-4-11"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:1-4-12"><a href="#lst:1-4-12"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:1-4-13"><a href="#lst:1-4-13"></a></span>
<span id="lst:1-4-14"><a href="#lst:1-4-14"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:1-4-15"><a href="#lst:1-4-15"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;a()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:1-4-16"><a href="#lst:1-4-16"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;b()&quot;</span><span class="kw">&gt;</span>B<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:1-4-17"><a href="#lst:1-4-17"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:1-4-18"><a href="#lst:1-4-18"></a></span>
<span id="lst:1-4-19"><a href="#lst:1-4-19"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/1-4.html" class="myiframe"></iframe>
</div>
<h2 data-number="1.5" id="乱数おみくじ"><span class="header-section-number">1.5</span> 乱数（おみくじ）</h2>
<p>タートルグラフィックス編でも作成したおみくじを作ってみましょう．</p>
<p>タートルではないJavascriptでは，random()関数は使えません． 代わりに，Math.random()関数を使います． Math.random()関数は，0以上1未満の小数を生成し，戻り値として返します．</p>
<p>したがって，例えば0〜3までの数字を生成したければ</p>
<pre><code>var x = Math.floor(Math.random() * 4)</code></pre>
<p>1〜6までの数字を生成したければ</p>
<pre><code>var x = Math.floor(Math.random() * 6) + 1</code></pre>
<p>というようにプログラムします．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:1-5')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:1-5" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:1-5-1"><a href="#lst:1-5-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:1-5-2"><a href="#lst:1-5-2"></a></span>
<span id="lst:1-5-3"><a href="#lst:1-5-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:1-5-4"><a href="#lst:1-5-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:1-5-5"><a href="#lst:1-5-5"></a>        <span class="kw">function</span> <span class="fu">a</span>() {</span>
<span id="lst:1-5-6"><a href="#lst:1-5-6"></a>            <span class="co">//0, 1の乱数を生成する</span></span>
<span id="lst:1-5-7"><a href="#lst:1-5-7"></a>            <span class="kw">var</span> x <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> <span class="dv">2</span>)</span>
<span id="lst:1-5-8"><a href="#lst:1-5-8"></a>            <span class="cf">if</span> (x <span class="op">==</span> <span class="dv">0</span>) {</span>
<span id="lst:1-5-9"><a href="#lst:1-5-9"></a>                <span class="bu">window</span><span class="op">.</span><span class="fu">alert</span>(<span class="st">&#39;あたり！&#39;</span>)<span class="op">;</span></span>
<span id="lst:1-5-10"><a href="#lst:1-5-10"></a>            } <span class="cf">else</span> {</span>
<span id="lst:1-5-11"><a href="#lst:1-5-11"></a>                <span class="bu">window</span><span class="op">.</span><span class="fu">alert</span>(<span class="st">&#39;はずれ．&#39;</span>)<span class="op">;</span></span>
<span id="lst:1-5-12"><a href="#lst:1-5-12"></a>            }</span>
<span id="lst:1-5-13"><a href="#lst:1-5-13"></a>        }         </span>
<span id="lst:1-5-14"><a href="#lst:1-5-14"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:1-5-15"><a href="#lst:1-5-15"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:1-5-16"><a href="#lst:1-5-16"></a></span>
<span id="lst:1-5-17"><a href="#lst:1-5-17"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:1-5-18"><a href="#lst:1-5-18"></a>    <span class="kw">&lt;h1&gt;</span>おみくじプログラム<span class="kw">&lt;/h1&gt;</span></span>
<span id="lst:1-5-19"><a href="#lst:1-5-19"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;a()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:1-5-20"><a href="#lst:1-5-20"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:1-5-21"><a href="#lst:1-5-21"></a></span>
<span id="lst:1-5-22"><a href="#lst:1-5-22"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/1-5.html" class="myiframe"></iframe>
</div>
<!-- ## 練習問題

### 勝率計算アプリケーション
次の動画で示すようなアプリケーションを作りなさい．

#### 動作仕様（動画）{.unnumbered}
<video src="11-1.mov" autoplay loop muted></video>

#### 仕様{.unnumbered}
<ul>
    <li>勝数と負数を入力し，計算ボタンを押すと，勝率（％）を計算し出力する．</li>
    <li>ファイル名を「winningrate.html」とすること</li>
</ul>

### BMI計算アプリケーション
次の動画で示すようなアプリケーションを作りなさい．

#### 動作仕様（動画）{.unnumbered}
<video src="11-2.mov" autoplay loop muted></video>

#### 仕様{.unnumbered}
- 身長と体重を入力し，計算ボタンを押すと，BMIを計算し出力する．
- ファイル名を「bmi.html」とすること -->
<h1 data-number="2" id="テキストフィールドとjavascriptの連携"><span class="header-section-number">2</span> テキストフィールドとJavaScriptの連携</h1>
<p>本章では，テキストフィールドへの入出力を学びます．</p>
<h2 data-number="2.1" id="テキストフィールドを作る"><span class="header-section-number">2.1</span> テキストフィールドを作る</h2>
<p>htmlを使ってテキストフィールドを作るには，inputタグを使います．</p>
<pre><code>&lt;input type=&quot;text&quot;&gt;</code></pre>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:2-1')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:2-1" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:2-1-1"><a href="#lst:2-1-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:2-1-2"><a href="#lst:2-1-2"></a></span>
<span id="lst:2-1-3"><a href="#lst:2-1-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:2-1-4"><a href="#lst:2-1-4"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:2-1-5"><a href="#lst:2-1-5"></a></span>
<span id="lst:2-1-6"><a href="#lst:2-1-6"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:2-1-7"><a href="#lst:2-1-7"></a>    <span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span></span>
<span id="lst:2-1-8"><a href="#lst:2-1-8"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:2-1-9"><a href="#lst:2-1-9"></a></span>
<span id="lst:2-1-10"><a href="#lst:2-1-10"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/2-1.html" class="myiframe"></iframe>
</div>
<h2 data-number="2.2" id="テキストフィールドの初期値を設定する"><span class="header-section-number">2.2</span> テキストフィールドの初期値を設定する</h2>
<p>テキストフィールドの初期値を指定するには，value属性を使います．</p>
<pre><code>&lt;input type=&quot;text&quot; value=&quot;2&quot;&gt;</code></pre>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:2-2')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:2-2" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:2-2-1"><a href="#lst:2-2-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:2-2-2"><a href="#lst:2-2-2"></a></span>
<span id="lst:2-2-3"><a href="#lst:2-2-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:2-2-4"><a href="#lst:2-2-4"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:2-2-5"><a href="#lst:2-2-5"></a></span>
<span id="lst:2-2-6"><a href="#lst:2-2-6"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:2-2-7"><a href="#lst:2-2-7"></a>    <span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> value=</span><span class="st">&quot;2&quot;</span><span class="kw">&gt;</span></span>
<span id="lst:2-2-8"><a href="#lst:2-2-8"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:2-2-9"><a href="#lst:2-2-9"></a></span>
<span id="lst:2-2-10"><a href="#lst:2-2-10"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/2-2.html" class="myiframe"></iframe>
</div>
<h2 data-number="2.3" id="テキストフィールドから値を取得する"><span class="header-section-number">2.3</span> テキストフィールドから値を取得する</h2>
<p>テキストフィールドに記入された文字を取得するには，</p>
<pre><code>var x = document.getElementById(&#39;[id名]&#39;).value;</code></pre>
<p>プログラムを使います．</p>
<pre><code>document.getElementById(&#39;[id名]&#39;)</code></pre>
<p>でbodyタグの中身から，[id名]のついた要素（タグ）を探し，そのタグの属性であるvalueを</p>
<pre><code>.value</code></pre>
<p>で取得し，変数xに格納します．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:2-3')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:2-3" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:2-3-1"><a href="#lst:2-3-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:2-3-2"><a href="#lst:2-3-2"></a></span>
<span id="lst:2-3-3"><a href="#lst:2-3-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:2-3-4"><a href="#lst:2-3-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:2-3-5"><a href="#lst:2-3-5"></a>        <span class="kw">function</span> <span class="fu">a</span>() {</span>
<span id="lst:2-3-6"><a href="#lst:2-3-6"></a>            <span class="kw">var</span> x <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;textfield1&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="lst:2-3-7"><a href="#lst:2-3-7"></a>            <span class="bu">window</span><span class="op">.</span><span class="fu">alert</span>(<span class="st">&#39;入力されたのは&#39;</span> <span class="op">+</span> x <span class="op">+</span> <span class="st">&#39;です．&#39;</span>)<span class="op">;</span></span>
<span id="lst:2-3-8"><a href="#lst:2-3-8"></a>        } </span>
<span id="lst:2-3-9"><a href="#lst:2-3-9"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:2-3-10"><a href="#lst:2-3-10"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:2-3-11"><a href="#lst:2-3-11"></a></span>
<span id="lst:2-3-12"><a href="#lst:2-3-12"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:2-3-13"><a href="#lst:2-3-13"></a>    <span class="kw">&lt;input</span><span class="ot"> id=</span><span class="st">&quot;textfield1&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span></span>
<span id="lst:2-3-14"><a href="#lst:2-3-14"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;a()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:2-3-15"><a href="#lst:2-3-15"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:2-3-16"><a href="#lst:2-3-16"></a></span>
<span id="lst:2-3-17"><a href="#lst:2-3-17"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/2-3.html" class="myiframe"></iframe>
</div>
<h2 data-number="2.4" id="テキストフィールドに値を入力する"><span class="header-section-number">2.4</span> テキストフィールドに値を入力する</h2>
<p>テキストフィールドに値を入力するには，</p>
<pre><code>document.getElementById(&#39;[id名]&#39;).value = x;</code></pre>
<p>(xは定義済みの変数)プログラムを使います．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:2-4')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:2-4" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:2-4-1"><a href="#lst:2-4-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:2-4-2"><a href="#lst:2-4-2"></a></span>
<span id="lst:2-4-3"><a href="#lst:2-4-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:2-4-4"><a href="#lst:2-4-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:2-4-5"><a href="#lst:2-4-5"></a>        <span class="kw">function</span> <span class="fu">a</span>() {</span>
<span id="lst:2-4-6"><a href="#lst:2-4-6"></a>            <span class="kw">var</span> x <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;textfield1&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="lst:2-4-7"><a href="#lst:2-4-7"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;textfield2&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="lst:2-4-8"><a href="#lst:2-4-8"></a>        } </span>
<span id="lst:2-4-9"><a href="#lst:2-4-9"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:2-4-10"><a href="#lst:2-4-10"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:2-4-11"><a href="#lst:2-4-11"></a></span>
<span id="lst:2-4-12"><a href="#lst:2-4-12"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:2-4-13"><a href="#lst:2-4-13"></a>    <span class="kw">&lt;input</span><span class="ot"> id=</span><span class="st">&quot;textfield1&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span></span>
<span id="lst:2-4-14"><a href="#lst:2-4-14"></a>    <span class="kw">&lt;input</span><span class="ot"> id=</span><span class="st">&quot;textfield2&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span></span>
<span id="lst:2-4-15"><a href="#lst:2-4-15"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;a()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:2-4-16"><a href="#lst:2-4-16"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:2-4-17"><a href="#lst:2-4-17"></a></span>
<span id="lst:2-4-18"><a href="#lst:2-4-18"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/2-4.html" class="myiframe"></iframe>
</div>
<h2 data-number="2.5" id="テキストフィールドから取得した文字列を数字に変換し計算を行う"><span class="header-section-number">2.5</span> テキストフィールドから取得した文字列を数字に変換し，計算を行う</h2>
<p>テキストフィールドから入力された値は，文字列になっています．したがって，入力された値を利用して計算をするには，数字の変数に変換する必要があります．</p>
<p>文字列を数字に変換するには，</p>
<pre><code>x = Number(x);</code></pre>
<p>(xは事前に定義しておくこと)プログラムを使います．</p>
<p>Number関数で，文字列を数字に変えることができます． さあ，足し算プログラムを作ってみましょう．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:2-5')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:2-5" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:2-5-1"><a href="#lst:2-5-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:2-5-2"><a href="#lst:2-5-2"></a></span>
<span id="lst:2-5-3"><a href="#lst:2-5-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:2-5-4"><a href="#lst:2-5-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:2-5-5"><a href="#lst:2-5-5"></a>        <span class="kw">function</span> <span class="fu">calc</span>() {</span>
<span id="lst:2-5-6"><a href="#lst:2-5-6"></a>            <span class="kw">var</span> a <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;textfield1&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="lst:2-5-7"><a href="#lst:2-5-7"></a>            a <span class="op">=</span> <span class="bu">Number</span>(a)<span class="op">;</span></span>
<span id="lst:2-5-8"><a href="#lst:2-5-8"></a>            <span class="kw">var</span> b <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;textfield2&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="lst:2-5-9"><a href="#lst:2-5-9"></a>            b <span class="op">=</span> <span class="bu">Number</span>(b)<span class="op">;</span></span>
<span id="lst:2-5-10"><a href="#lst:2-5-10"></a>            <span class="kw">var</span> c <span class="op">=</span> a <span class="op">+</span> b<span class="op">;</span></span>
<span id="lst:2-5-11"><a href="#lst:2-5-11"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;textfield3&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> c<span class="op">;</span></span>
<span id="lst:2-5-12"><a href="#lst:2-5-12"></a>        } </span>
<span id="lst:2-5-13"><a href="#lst:2-5-13"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:2-5-14"><a href="#lst:2-5-14"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:2-5-15"><a href="#lst:2-5-15"></a></span>
<span id="lst:2-5-16"><a href="#lst:2-5-16"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:2-5-17"><a href="#lst:2-5-17"></a>    <span class="kw">&lt;input</span><span class="ot"> id=</span><span class="st">&quot;textfield1&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span></span>
<span id="lst:2-5-18"><a href="#lst:2-5-18"></a>    +</span>
<span id="lst:2-5-19"><a href="#lst:2-5-19"></a>    <span class="kw">&lt;input</span><span class="ot"> id=</span><span class="st">&quot;textfield2&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span></span>
<span id="lst:2-5-20"><a href="#lst:2-5-20"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;calc()&quot;</span><span class="kw">&gt;</span>=<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:2-5-21"><a href="#lst:2-5-21"></a>    <span class="kw">&lt;input</span><span class="ot"> id=</span><span class="st">&quot;textfield3&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span></span>
<span id="lst:2-5-22"><a href="#lst:2-5-22"></a></span>
<span id="lst:2-5-23"><a href="#lst:2-5-23"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:2-5-24"><a href="#lst:2-5-24"></a></span>
<span id="lst:2-5-25"><a href="#lst:2-5-25"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/2-5.html" class="myiframe"></iframe>
</div>
<h1 data-number="3" id="javascriptによるhtmlの生成"><span class="header-section-number">3</span> JavascriptによるHTMLの生成</h1>
<p>本章では，JavascriptでHTMLを生成し，リストや表を作る方法を学びます．</p>
<h2 data-number="3.1" id="タグの中身を書き換えるinnerhtml"><span class="header-section-number">3.1</span> タグの中身を書き換える（innerHTML）</h2>
<p>document.getElementById(‘xx’)で取得したタグの中身を書き換えることができます．</p>
<pre><code>document.getElementById(&#39;xx&#39;).innerHTML = &#39;hello, world&#39;;</code></pre>
<p>document.getElementById(‘xx’)で取得したタグの中身を.innerHTMLで取得したり，書き換えたりすることができます．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:3-1')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:3-1" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:3-1-1"><a href="#lst:3-1-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:3-1-2"><a href="#lst:3-1-2"></a></span>
<span id="lst:3-1-3"><a href="#lst:3-1-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:3-1-4"><a href="#lst:3-1-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:3-1-5"><a href="#lst:3-1-5"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:3-1-6"><a href="#lst:3-1-6"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;hello&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&#39;hello, world!&#39;</span></span>
<span id="lst:3-1-7"><a href="#lst:3-1-7"></a>        }</span>
<span id="lst:3-1-8"><a href="#lst:3-1-8"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:3-1-9"><a href="#lst:3-1-9"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:3-1-10"><a href="#lst:3-1-10"></a></span>
<span id="lst:3-1-11"><a href="#lst:3-1-11"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:3-1-12"><a href="#lst:3-1-12"></a>    <span class="kw">&lt;h1</span><span class="ot"> id=</span><span class="st">&quot;hello&quot;</span><span class="kw">&gt;</span>Title<span class="kw">&lt;/h1&gt;</span></span>
<span id="lst:3-1-13"><a href="#lst:3-1-13"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:3-1-14"><a href="#lst:3-1-14"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:3-1-15"><a href="#lst:3-1-15"></a></span>
<span id="lst:3-1-16"><a href="#lst:3-1-16"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/3-1.html" class="myiframe"></iframe>
</div>
<h3 data-number="3.1.1" id="hint"><span class="header-section-number">3.1.1</span> hint</h3>
<p>先週習ったテキストフィールドの書き換えでは，valueの属性値を書き換えたので，</p>
<pre><code>document.getElementById(&#39;xx&#39;).value = &#39;xx&#39;;</code></pre>
<p>という記述になりました．タグの中身を書き換える場合はinnerHTMLを使います． 間違えやすいので注意．</p>
<h2 data-number="3.2" id="リスト箇条書きの要素を加える"><span class="header-section-number">3.2</span> リスト（箇条書き）の要素を加える</h2>
<p>innerHTMLにセットする文字列には，HTMLを含めることができます．</p>
<pre><code>document.getElementById(&#39;xx&#39;).innerHTML = &#39;&lt;li&gt;りんご&lt;/li&gt;&#39;</code></pre>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:3-2')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:3-2" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:3-2-1"><a href="#lst:3-2-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:3-2-2"><a href="#lst:3-2-2"></a></span>
<span id="lst:3-2-3"><a href="#lst:3-2-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:3-2-4"><a href="#lst:3-2-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:3-2-5"><a href="#lst:3-2-5"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:3-2-6"><a href="#lst:3-2-6"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;fruits&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&#39;&lt;li&gt;りんご&lt;/li&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:3-2-7"><a href="#lst:3-2-7"></a>        }</span>
<span id="lst:3-2-8"><a href="#lst:3-2-8"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:3-2-9"><a href="#lst:3-2-9"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:3-2-10"><a href="#lst:3-2-10"></a></span>
<span id="lst:3-2-11"><a href="#lst:3-2-11"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:3-2-12"><a href="#lst:3-2-12"></a>    <span class="kw">&lt;h1&gt;</span>箇条書き<span class="kw">&lt;/h1&gt;</span></span>
<span id="lst:3-2-13"><a href="#lst:3-2-13"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:3-2-14"><a href="#lst:3-2-14"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:3-2-15"><a href="#lst:3-2-15"></a>    <span class="kw">&lt;ul</span><span class="ot"> id=</span><span class="st">&quot;fruits&quot;</span><span class="kw">&gt;</span></span>
<span id="lst:3-2-16"><a href="#lst:3-2-16"></a>    <span class="kw">&lt;/ul&gt;</span></span>
<span id="lst:3-2-17"><a href="#lst:3-2-17"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:3-2-18"><a href="#lst:3-2-18"></a></span>
<span id="lst:3-2-19"><a href="#lst:3-2-19"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/3-2.html" class="myiframe"></iframe>
</div>
<h3 data-number="3.2.1" id="hint-1"><span class="header-section-number">3.2.1</span> hint</h3>
<p>番号なしリストはulタグ，リストの要素は，liタグを使うのでしたね．</p>
<h2 data-number="3.3" id="複数の要素を加える"><span class="header-section-number">3.3</span> 複数の要素を加える</h2>
<p>複数の要素を加えるには，まず</p>
<pre><code>var html = &#39;&#39;;</code></pre>
<p>で，文字列型の変数を用意して，</p>
<pre><code>html = html + &#39;つなげたい文字列&#39;;</code></pre>
<p>というプログラムを書くことで，文字列を次々に連結していきます．</p>
<p>最後に，innerHTML属性を使うことで，作られた文字列を指定されたidのタグにセットします．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:3-3')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:3-3" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:3-3-1"><a href="#lst:3-3-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:3-3-2"><a href="#lst:3-3-2"></a></span>
<span id="lst:3-3-3"><a href="#lst:3-3-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:3-3-4"><a href="#lst:3-3-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:3-3-5"><a href="#lst:3-3-5"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:3-3-6"><a href="#lst:3-3-6"></a>            <span class="kw">var</span> html <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="lst:3-3-7"><a href="#lst:3-3-7"></a>            html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;li&gt;りんご&lt;/li&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:3-3-8"><a href="#lst:3-3-8"></a>            html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;li&gt;みかん&lt;/li&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:3-3-9"><a href="#lst:3-3-9"></a>            html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;li&gt;いちご&lt;/li&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:3-3-10"><a href="#lst:3-3-10"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;fruits&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> html<span class="op">;</span></span>
<span id="lst:3-3-11"><a href="#lst:3-3-11"></a>        }</span>
<span id="lst:3-3-12"><a href="#lst:3-3-12"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:3-3-13"><a href="#lst:3-3-13"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:3-3-14"><a href="#lst:3-3-14"></a></span>
<span id="lst:3-3-15"><a href="#lst:3-3-15"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:3-3-16"><a href="#lst:3-3-16"></a>    <span class="kw">&lt;h1&gt;</span>箇条書き<span class="kw">&lt;/h1&gt;</span></span>
<span id="lst:3-3-17"><a href="#lst:3-3-17"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:3-3-18"><a href="#lst:3-3-18"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:3-3-19"><a href="#lst:3-3-19"></a>    <span class="kw">&lt;ul</span><span class="ot"> id=</span><span class="st">&quot;fruits&quot;</span><span class="kw">&gt;</span></span>
<span id="lst:3-3-20"><a href="#lst:3-3-20"></a>    <span class="kw">&lt;/ul&gt;</span></span>
<span id="lst:3-3-21"><a href="#lst:3-3-21"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:3-3-22"><a href="#lst:3-3-22"></a></span>
<span id="lst:3-3-23"><a href="#lst:3-3-23"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/3-3.html" class="myiframe"></iframe>
</div>
<h2 data-number="3.4" id="繰り返しプログラムで要素を加える"><span class="header-section-number">3.4</span> 繰り返しプログラムで要素を加える</h2>
<p>文字列を連結してHTML出力する方法がわかったら， 応用として，繰り返しプログラムでタグを生成してみましょう．</p>
<p>先程と同様に</p>
<pre><code>var html = &#39;&#39;;</code></pre>
<p>で，文字列型の変数を用意し，繰り返しの中で</p>
<pre><code>html = html + &#39;&lt;li&gt;&#39; + i + &#39;&lt;/li&gt;&#39;;</code></pre>
<p>というプログラムを書くことで，数を数えるプログラムを作ることができます．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:3-4')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:3-4" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:3-4-1"><a href="#lst:3-4-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:3-4-2"><a href="#lst:3-4-2"></a></span>
<span id="lst:3-4-3"><a href="#lst:3-4-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:3-4-4"><a href="#lst:3-4-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:3-4-5"><a href="#lst:3-4-5"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:3-4-6"><a href="#lst:3-4-6"></a>            <span class="kw">var</span> html <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="lst:3-4-7"><a href="#lst:3-4-7"></a>            <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="dv">10</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="lst:3-4-8"><a href="#lst:3-4-8"></a>                html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;li&gt;&#39;</span> <span class="op">+</span> i <span class="op">+</span> <span class="st">&#39;&lt;/li&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:3-4-9"><a href="#lst:3-4-9"></a>            }</span>
<span id="lst:3-4-10"><a href="#lst:3-4-10"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;fruits&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> html<span class="op">;</span></span>
<span id="lst:3-4-11"><a href="#lst:3-4-11"></a>        }</span>
<span id="lst:3-4-12"><a href="#lst:3-4-12"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:3-4-13"><a href="#lst:3-4-13"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:3-4-14"><a href="#lst:3-4-14"></a></span>
<span id="lst:3-4-15"><a href="#lst:3-4-15"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:3-4-16"><a href="#lst:3-4-16"></a>    <span class="kw">&lt;h1&gt;</span>箇条書き<span class="kw">&lt;/h1&gt;</span></span>
<span id="lst:3-4-17"><a href="#lst:3-4-17"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:3-4-18"><a href="#lst:3-4-18"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:3-4-19"><a href="#lst:3-4-19"></a>    <span class="kw">&lt;ul</span><span class="ot"> id=</span><span class="st">&quot;fruits&quot;</span><span class="kw">&gt;</span></span>
<span id="lst:3-4-20"><a href="#lst:3-4-20"></a>    <span class="kw">&lt;/ul&gt;</span></span>
<span id="lst:3-4-21"><a href="#lst:3-4-21"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:3-4-22"><a href="#lst:3-4-22"></a></span>
<span id="lst:3-4-23"><a href="#lst:3-4-23"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/3-4.html" class="myiframe"></iframe>
</div>
<h2 data-number="3.5" id="ボタンを押すたびに要素を追加する"><span class="header-section-number">3.5</span> ボタンを押すたびに要素を追加する</h2>
<p>先程までのプログラムでは，var html = ’’で文字列を初期化して，HTMLを生成していたので，ボタンを複数回押しても，出力される文字列は同様でしたが，一行目を次のように書き換えて</p>
<pre><code>var html = document.getElementById(&#39;fruits&#39;).innerHTML;</code></pre>
<p>ボタンを押すたびに追記されるように改造することができます．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:3-5')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:3-5" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:3-5-1"><a href="#lst:3-5-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:3-5-2"><a href="#lst:3-5-2"></a></span>
<span id="lst:3-5-3"><a href="#lst:3-5-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:3-5-4"><a href="#lst:3-5-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:3-5-5"><a href="#lst:3-5-5"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:3-5-6"><a href="#lst:3-5-6"></a>            <span class="kw">var</span> html <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;fruits&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span><span class="op">;</span></span>
<span id="lst:3-5-7"><a href="#lst:3-5-7"></a>            html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;li&gt;めろん&lt;/li&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:3-5-8"><a href="#lst:3-5-8"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;fruits&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> html<span class="op">;</span></span>
<span id="lst:3-5-9"><a href="#lst:3-5-9"></a>        }</span>
<span id="lst:3-5-10"><a href="#lst:3-5-10"></a>        <span class="kw">function</span> <span class="fu">buttonBPressed</span>() {</span>
<span id="lst:3-5-11"><a href="#lst:3-5-11"></a>            <span class="kw">var</span> li <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">&#39;li&#39;</span>)<span class="op">;</span></span>
<span id="lst:3-5-12"><a href="#lst:3-5-12"></a>            li<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&#39;めろん&#39;</span><span class="op">;</span></span>
<span id="lst:3-5-13"><a href="#lst:3-5-13"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;fruits&#39;</span>)<span class="op">.</span><span class="fu">appendChild</span>(li)<span class="op">;</span></span>
<span id="lst:3-5-14"><a href="#lst:3-5-14"></a>        }</span>
<span id="lst:3-5-15"><a href="#lst:3-5-15"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:3-5-16"><a href="#lst:3-5-16"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:3-5-17"><a href="#lst:3-5-17"></a></span>
<span id="lst:3-5-18"><a href="#lst:3-5-18"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:3-5-19"><a href="#lst:3-5-19"></a>    <span class="kw">&lt;h1&gt;</span>箇条書き<span class="kw">&lt;/h1&gt;</span></span>
<span id="lst:3-5-20"><a href="#lst:3-5-20"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:3-5-21"><a href="#lst:3-5-21"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>B<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:3-5-22"><a href="#lst:3-5-22"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:3-5-23"><a href="#lst:3-5-23"></a>    <span class="kw">&lt;ul</span><span class="ot"> id=</span><span class="st">&quot;fruits&quot;</span><span class="kw">&gt;</span></span>
<span id="lst:3-5-24"><a href="#lst:3-5-24"></a>    <span class="kw">&lt;/ul&gt;</span></span>
<span id="lst:3-5-25"><a href="#lst:3-5-25"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:3-5-26"><a href="#lst:3-5-26"></a></span>
<span id="lst:3-5-27"><a href="#lst:3-5-27"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/3-5.html" class="myiframe"></iframe>
</div>
<h3 class="unnumbered" data-number="" id="tips">tips</h3>
<p>ボタンBが押されたときの処理では，appendChildを使った別の書き方の例を載せてあります．</p>
<pre><code>var li = document.createElement(&#39;li&#39;);
li.innerHTML = &#39;めろん&#39;;
document.getElementById(&#39;fruits&#39;).appendChild(li);</code></pre>
<h2 data-number="3.6" id="テキストフィールドから入力したものをリストに追加する"><span class="header-section-number">3.6</span> テキストフィールドから入力したものをリストに追加する</h2>
<p>これまでの応用で，テキストフィールドから入力されたものをリストに追加するプログラムを作ることができます．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:3-6')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:3-6" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:3-6-1"><a href="#lst:3-6-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:3-6-2"><a href="#lst:3-6-2"></a></span>
<span id="lst:3-6-3"><a href="#lst:3-6-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:3-6-4"><a href="#lst:3-6-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:3-6-5"><a href="#lst:3-6-5"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:3-6-6"><a href="#lst:3-6-6"></a>            <span class="kw">var</span> fruit <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;input-fruit&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="lst:3-6-7"><a href="#lst:3-6-7"></a>            <span class="kw">var</span> html <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;fruits&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span><span class="op">;</span></span>
<span id="lst:3-6-8"><a href="#lst:3-6-8"></a>            html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;li&gt;&#39;</span> <span class="op">+</span> fruit <span class="op">+</span> <span class="st">&#39;&lt;/li&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:3-6-9"><a href="#lst:3-6-9"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;fruits&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> html<span class="op">;</span></span>
<span id="lst:3-6-10"><a href="#lst:3-6-10"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;input-fruit&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="lst:3-6-11"><a href="#lst:3-6-11"></a>        }</span>
<span id="lst:3-6-12"><a href="#lst:3-6-12"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:3-6-13"><a href="#lst:3-6-13"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:3-6-14"><a href="#lst:3-6-14"></a></span>
<span id="lst:3-6-15"><a href="#lst:3-6-15"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:3-6-16"><a href="#lst:3-6-16"></a>    <span class="kw">&lt;h1&gt;</span>箇条書き<span class="kw">&lt;/h1&gt;</span></span>
<span id="lst:3-6-17"><a href="#lst:3-6-17"></a>    <span class="kw">&lt;input</span><span class="ot"> id=</span><span class="st">&quot;input-fruit&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span></span>
<span id="lst:3-6-18"><a href="#lst:3-6-18"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:3-6-19"><a href="#lst:3-6-19"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:3-6-20"><a href="#lst:3-6-20"></a>    <span class="kw">&lt;ul</span><span class="ot"> id=</span><span class="st">&quot;fruits&quot;</span><span class="kw">&gt;</span></span>
<span id="lst:3-6-21"><a href="#lst:3-6-21"></a>    <span class="kw">&lt;/ul&gt;</span></span>
<span id="lst:3-6-22"><a href="#lst:3-6-22"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:3-6-23"><a href="#lst:3-6-23"></a></span>
<span id="lst:3-6-24"><a href="#lst:3-6-24"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/3-6.html" class="myiframe"></iframe>
</div>
<h2 data-number="3.7" id="表の生成"><span class="header-section-number">3.7</span> 表の生成</h2>
<p>tableタグの中身を生成することで，表を生成することもできます．</p>
<p>表の一行はtrタグ，セルはtdタグで表現します．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:3-7')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:3-7" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:3-7-1"><a href="#lst:3-7-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:3-7-2"><a href="#lst:3-7-2"></a></span>
<span id="lst:3-7-3"><a href="#lst:3-7-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:3-7-4"><a href="#lst:3-7-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:3-7-5"><a href="#lst:3-7-5"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:3-7-6"><a href="#lst:3-7-6"></a>            <span class="kw">var</span> html <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="lst:3-7-7"><a href="#lst:3-7-7"></a>            html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;table border=&quot;1&quot;&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:3-7-8"><a href="#lst:3-7-8"></a>            html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;tr&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:3-7-9"><a href="#lst:3-7-9"></a>            html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;td&gt;国語&lt;/td&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:3-7-10"><a href="#lst:3-7-10"></a>            html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;td&gt;100&lt;/td&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:3-7-11"><a href="#lst:3-7-11"></a>            html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;/tr&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:3-7-12"><a href="#lst:3-7-12"></a>            html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;tr&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:3-7-13"><a href="#lst:3-7-13"></a>            html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;td&gt;算数&lt;/td&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:3-7-14"><a href="#lst:3-7-14"></a>            html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;td&gt;90&lt;/td&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:3-7-15"><a href="#lst:3-7-15"></a>            html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;/tr&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:3-7-16"><a href="#lst:3-7-16"></a>            html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;/table&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:3-7-17"><a href="#lst:3-7-17"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;table1&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> html<span class="op">;</span></span>
<span id="lst:3-7-18"><a href="#lst:3-7-18"></a>        }</span>
<span id="lst:3-7-19"><a href="#lst:3-7-19"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:3-7-20"><a href="#lst:3-7-20"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:3-7-21"><a href="#lst:3-7-21"></a></span>
<span id="lst:3-7-22"><a href="#lst:3-7-22"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:3-7-23"><a href="#lst:3-7-23"></a>    <span class="kw">&lt;h1&gt;</span>表<span class="kw">&lt;/h1&gt;</span></span>
<span id="lst:3-7-24"><a href="#lst:3-7-24"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:3-7-25"><a href="#lst:3-7-25"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:3-7-26"><a href="#lst:3-7-26"></a>    <span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;table1&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></span>
<span id="lst:3-7-27"><a href="#lst:3-7-27"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:3-7-28"><a href="#lst:3-7-28"></a></span>
<span id="lst:3-7-29"><a href="#lst:3-7-29"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/3-7.html" class="myiframe"></iframe>
</div>
<h3 data-number="3.7.1" id="tips-1"><span class="header-section-number">3.7.1</span> tips</h3>
<p>ここでは，HTML部でtableタグを用意するのではなく，divタグを用意して，divタグの中身を生成するプログラムの最中で，tableタグを生成しています．この場合はどちらでも良いのですが，divタグを指定することによりより汎用的なプログラムを作ることができます．</p>
<h1 data-number="4" id="html生成-応用編"><span class="header-section-number">4</span> HTML生成　応用編</h1>
<p>本章では，HTML生成に関する２つの応用プログラムを学びます．</p>
<h2 data-number="4.1" id="プルダウンメニュー"><span class="header-section-number">4.1</span> プルダウンメニュー</h2>
<p>プルダウンメニューを作成するには，selectタグを使います．</p>
<pre><code>&lt;select id=&quot;input-repeatnum&quot;&gt;
    &lt;option value=&quot;10&quot;&gt;10回&lt;/option&gt;
    &lt;option value=&quot;15&quot;&gt;15回&lt;/option&gt;
&lt;/select&gt;</code></pre>
<p>selectタグの中のoptionタグで，選択肢を指定します． value属性は，その選択した選択されたときに取得される値（.valueで取得できる属性） で，optionタグの中身（10回，15回など）は，画面に表示されるテキストです．</p>
<p>選択された選択肢の値は，Javascriptからは次のようなプログラムで取得することができます．</p>
<pre><code>var n = document.getElementById(&#39;xx&#39;).value;</code></pre>
<p>テキストフィールドと同様の方法です．</p>
<p>このプログラムは，プルダウンメニューで指定された回数分，数を数えるプログラムです．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:4-1')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:4-1" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:4-1-1"><a href="#lst:4-1-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:4-1-2"><a href="#lst:4-1-2"></a></span>
<span id="lst:4-1-3"><a href="#lst:4-1-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:4-1-4"><a href="#lst:4-1-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:4-1-5"><a href="#lst:4-1-5"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:4-1-6"><a href="#lst:4-1-6"></a>            <span class="kw">var</span> n <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;input-repeatnum&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="lst:4-1-7"><a href="#lst:4-1-7"></a>            n <span class="op">=</span> <span class="bu">Number</span>(n)<span class="op">;</span></span>
<span id="lst:4-1-8"><a href="#lst:4-1-8"></a>            <span class="kw">var</span> html <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="lst:4-1-9"><a href="#lst:4-1-9"></a>            <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="lst:4-1-10"><a href="#lst:4-1-10"></a>                html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;li&gt;&#39;</span> <span class="op">+</span> i <span class="op">+</span> <span class="st">&#39;&lt;/li&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:4-1-11"><a href="#lst:4-1-11"></a>            }</span>
<span id="lst:4-1-12"><a href="#lst:4-1-12"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;list1&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> html<span class="op">;</span></span>
<span id="lst:4-1-13"><a href="#lst:4-1-13"></a>        }</span>
<span id="lst:4-1-14"><a href="#lst:4-1-14"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:4-1-15"><a href="#lst:4-1-15"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:4-1-16"><a href="#lst:4-1-16"></a></span>
<span id="lst:4-1-17"><a href="#lst:4-1-17"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:4-1-18"><a href="#lst:4-1-18"></a>    <span class="kw">&lt;h1&gt;</span>１からNまでの数字を数えるプログラム<span class="kw">&lt;/h1&gt;</span></span>
<span id="lst:4-1-19"><a href="#lst:4-1-19"></a>    数える回数（N）：</span>
<span id="lst:4-1-20"><a href="#lst:4-1-20"></a>    <span class="kw">&lt;select</span><span class="ot"> id=</span><span class="st">&quot;input-repeatnum&quot;</span><span class="kw">&gt;</span></span>
<span id="lst:4-1-21"><a href="#lst:4-1-21"></a>        <span class="kw">&lt;option</span><span class="ot"> value=</span><span class="st">&quot;10&quot;</span><span class="kw">&gt;</span>10回<span class="kw">&lt;/option&gt;</span></span>
<span id="lst:4-1-22"><a href="#lst:4-1-22"></a>        <span class="kw">&lt;option</span><span class="ot"> value=</span><span class="st">&quot;15&quot;</span><span class="kw">&gt;</span>15回<span class="kw">&lt;/option&gt;</span></span>
<span id="lst:4-1-23"><a href="#lst:4-1-23"></a>        <span class="kw">&lt;option</span><span class="ot"> value=</span><span class="st">&quot;20&quot;</span><span class="kw">&gt;</span>20回<span class="kw">&lt;/option&gt;</span></span>
<span id="lst:4-1-24"><a href="#lst:4-1-24"></a>    <span class="kw">&lt;/select&gt;</span></span>
<span id="lst:4-1-25"><a href="#lst:4-1-25"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:4-1-26"><a href="#lst:4-1-26"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:4-1-27"><a href="#lst:4-1-27"></a>    <span class="kw">&lt;ul</span><span class="ot"> id=</span><span class="st">&quot;list1&quot;</span><span class="kw">&gt;&lt;/ul&gt;</span></span>
<span id="lst:4-1-28"><a href="#lst:4-1-28"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:4-1-29"><a href="#lst:4-1-29"></a></span>
<span id="lst:4-1-30"><a href="#lst:4-1-30"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/4-1.html" class="myiframe"></iframe>
</div>
<h2 data-number="4.2" id="合計を求める"><span class="header-section-number">4.2</span> 合計を求める</h2>
<p>前の例題について，１からNまで数えるだけでなく，その数字までの総和を求めるプログラムに改造してみましょう．</p>
<p>９行目で，</p>
<pre><code>var sum = 0;</code></pre>
<p>と，総和を保存しておく変数を用意しておき，</p>
<p>１１行目で</p>
<pre><code>sum = sum + i;</code></pre>
<p>と，保存してある総和に，今数えている数(iに保存されている)を加算します．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:4-2')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:4-2" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:4-2-1"><a href="#lst:4-2-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:4-2-2"><a href="#lst:4-2-2"></a></span>
<span id="lst:4-2-3"><a href="#lst:4-2-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:4-2-4"><a href="#lst:4-2-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:4-2-5"><a href="#lst:4-2-5"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:4-2-6"><a href="#lst:4-2-6"></a>            <span class="kw">var</span> n <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;input-repeatnum&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="lst:4-2-7"><a href="#lst:4-2-7"></a>            n <span class="op">=</span> <span class="bu">Number</span>(n)<span class="op">;</span></span>
<span id="lst:4-2-8"><a href="#lst:4-2-8"></a>            <span class="kw">var</span> html <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="lst:4-2-9"><a href="#lst:4-2-9"></a>            <span class="kw">var</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="lst:4-2-10"><a href="#lst:4-2-10"></a>            <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="lst:4-2-11"><a href="#lst:4-2-11"></a>                sum <span class="op">=</span> sum <span class="op">+</span> i<span class="op">;</span></span>
<span id="lst:4-2-12"><a href="#lst:4-2-12"></a>                html <span class="op">=</span> html <span class="op">+</span> <span class="st">&#39;&lt;li&gt;&#39;</span> <span class="op">+</span> sum <span class="op">+</span> <span class="st">&#39;&lt;/li&gt;&#39;</span><span class="op">;</span></span>
<span id="lst:4-2-13"><a href="#lst:4-2-13"></a>            }</span>
<span id="lst:4-2-14"><a href="#lst:4-2-14"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;list1&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> html<span class="op">;</span></span>
<span id="lst:4-2-15"><a href="#lst:4-2-15"></a>        }</span>
<span id="lst:4-2-16"><a href="#lst:4-2-16"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:4-2-17"><a href="#lst:4-2-17"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:4-2-18"><a href="#lst:4-2-18"></a></span>
<span id="lst:4-2-19"><a href="#lst:4-2-19"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:4-2-20"><a href="#lst:4-2-20"></a>    <span class="kw">&lt;h1&gt;</span>１からNまでの総和を求めるプログラム<span class="kw">&lt;/h1&gt;</span></span>
<span id="lst:4-2-21"><a href="#lst:4-2-21"></a>    求める回数（N）：</span>
<span id="lst:4-2-22"><a href="#lst:4-2-22"></a>    <span class="kw">&lt;select</span><span class="ot"> id=</span><span class="st">&quot;input-repeatnum&quot;</span><span class="kw">&gt;</span></span>
<span id="lst:4-2-23"><a href="#lst:4-2-23"></a>        <span class="kw">&lt;option</span><span class="ot"> value=</span><span class="st">&quot;10&quot;</span><span class="kw">&gt;</span>10回<span class="kw">&lt;/option&gt;</span></span>
<span id="lst:4-2-24"><a href="#lst:4-2-24"></a>        <span class="kw">&lt;option</span><span class="ot"> value=</span><span class="st">&quot;15&quot;</span><span class="kw">&gt;</span>15回<span class="kw">&lt;/option&gt;</span></span>
<span id="lst:4-2-25"><a href="#lst:4-2-25"></a>        <span class="kw">&lt;option</span><span class="ot"> value=</span><span class="st">&quot;20&quot;</span><span class="kw">&gt;</span>20回<span class="kw">&lt;/option&gt;</span></span>
<span id="lst:4-2-26"><a href="#lst:4-2-26"></a>    <span class="kw">&lt;/select&gt;</span></span>
<span id="lst:4-2-27"><a href="#lst:4-2-27"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:4-2-28"><a href="#lst:4-2-28"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:4-2-29"><a href="#lst:4-2-29"></a>    <span class="kw">&lt;ul</span><span class="ot"> id=</span><span class="st">&quot;list1&quot;</span><span class="kw">&gt;&lt;/ul&gt;</span></span>
<span id="lst:4-2-30"><a href="#lst:4-2-30"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:4-2-31"><a href="#lst:4-2-31"></a></span>
<span id="lst:4-2-32"><a href="#lst:4-2-32"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/4-2.html" class="myiframe"></iframe>
</div>
<h1 data-number="5" id="ローカル変数とグローバル変数"><span class="header-section-number">5</span> ローカル変数とグローバル変数</h1>
<p>本章では，ローカル変数とグローバル変数について学びます．</p>
<h2 data-number="5.1" id="ローカル変数"><span class="header-section-number">5.1</span> ローカル変数</h2>
<p>関数(function)内に定義された変数(var)が関数内でのみ有効であることは，第１部の教材「変数のスコープ」で学習しました．関数の中に定義した変数は関数ブロック内で有効なので，関数ブロックの外で変数を参照することはできません．</p>
<p>ここでは，次のようなプログラムで，ボタンが何度も押され，関数がその都度呼ばれる場面を考えてみましょう．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:5-1')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:5-1" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:5-1-1"><a href="#lst:5-1-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:5-1-2"><a href="#lst:5-1-2"></a></span>
<span id="lst:5-1-3"><a href="#lst:5-1-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:5-1-4"><a href="#lst:5-1-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:5-1-5"><a href="#lst:5-1-5"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:5-1-6"><a href="#lst:5-1-6"></a>            <span class="kw">var</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="lst:5-1-7"><a href="#lst:5-1-7"></a>            x <span class="op">=</span> x <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="lst:5-1-8"><a href="#lst:5-1-8"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;label1&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="lst:5-1-9"><a href="#lst:5-1-9"></a>        }</span>
<span id="lst:5-1-10"><a href="#lst:5-1-10"></a></span>
<span id="lst:5-1-11"><a href="#lst:5-1-11"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:5-1-12"><a href="#lst:5-1-12"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:5-1-13"><a href="#lst:5-1-13"></a></span>
<span id="lst:5-1-14"><a href="#lst:5-1-14"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:5-1-15"><a href="#lst:5-1-15"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:5-1-16"><a href="#lst:5-1-16"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:5-1-17"><a href="#lst:5-1-17"></a>    <span class="kw">&lt;p</span><span class="ot"> id=</span><span class="st">&quot;label1&quot;</span><span class="kw">&gt;</span>0<span class="kw">&lt;/p&gt;</span></span>
<span id="lst:5-1-18"><a href="#lst:5-1-18"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:5-1-19"><a href="#lst:5-1-19"></a></span>
<span id="lst:5-1-20"><a href="#lst:5-1-20"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/5-1.html" class="myiframe"></iframe>
</div>
<p>buttonAPressed()関数内に変数xを定義し，0で初期化します．</p>
<pre><code>var x = 0;</code></pre>
<p>関数内で定義されたローカル変数（局所変数）は，関数の呼び出し毎に毎回保存領域が確保され，初期化され，関数が終わると消滅する呼び出し１回限り有効な変数です．したがって，ボタンを何度も押し，関数を何度実行しても，表示されるのは１のままです．</p>
<h2 data-number="5.2" id="グローバル変数"><span class="header-section-number">5.2</span> グローバル変数</h2>
<p>関数(function)の外側に定義された変数(var)は，すべての関数で有効なグローバル変数（広域変数）となります． グローバル変数はどの関数からもその値を読み書きすることができます．プログラムが読み込まれると同時に初期化されて，プログラムが終了するまで値を保持し続けます．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:5-2')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:5-2" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:5-2-1"><a href="#lst:5-2-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:5-2-2"><a href="#lst:5-2-2"></a></span>
<span id="lst:5-2-3"><a href="#lst:5-2-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:5-2-4"><a href="#lst:5-2-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:5-2-5"><a href="#lst:5-2-5"></a>        <span class="kw">var</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="lst:5-2-6"><a href="#lst:5-2-6"></a></span>
<span id="lst:5-2-7"><a href="#lst:5-2-7"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:5-2-8"><a href="#lst:5-2-8"></a>            x <span class="op">=</span> x <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="lst:5-2-9"><a href="#lst:5-2-9"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;label1&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="lst:5-2-10"><a href="#lst:5-2-10"></a>        }</span>
<span id="lst:5-2-11"><a href="#lst:5-2-11"></a></span>
<span id="lst:5-2-12"><a href="#lst:5-2-12"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:5-2-13"><a href="#lst:5-2-13"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:5-2-14"><a href="#lst:5-2-14"></a></span>
<span id="lst:5-2-15"><a href="#lst:5-2-15"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:5-2-16"><a href="#lst:5-2-16"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:5-2-17"><a href="#lst:5-2-17"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:5-2-18"><a href="#lst:5-2-18"></a>    <span class="kw">&lt;p</span><span class="ot"> id=</span><span class="st">&quot;label1&quot;</span><span class="kw">&gt;</span>0<span class="kw">&lt;/p&gt;</span></span>
<span id="lst:5-2-19"><a href="#lst:5-2-19"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:5-2-20"><a href="#lst:5-2-20"></a></span>
<span id="lst:5-2-21"><a href="#lst:5-2-21"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/5-2.html" class="myiframe"></iframe>
</div>
<p>今度のプログラムでは，ボタンを何度押しても，前回の値が保存されているので，１ずつカウントアップするプログラムを作ることができました．</p>
<h2 data-number="5.3" id="グローバル変数２"><span class="header-section-number">5.3</span> グローバル変数（２）</h2>
<p>グローバル変数は関数間で値を共有し，どの関数からもその値を読み書きすることができます．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:5-3')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:5-3" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:5-3-1"><a href="#lst:5-3-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:5-3-2"><a href="#lst:5-3-2"></a></span>
<span id="lst:5-3-3"><a href="#lst:5-3-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:5-3-4"><a href="#lst:5-3-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:5-3-5"><a href="#lst:5-3-5"></a>        <span class="kw">var</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="lst:5-3-6"><a href="#lst:5-3-6"></a></span>
<span id="lst:5-3-7"><a href="#lst:5-3-7"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:5-3-8"><a href="#lst:5-3-8"></a>            x <span class="op">=</span> x <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="lst:5-3-9"><a href="#lst:5-3-9"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;label1&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="lst:5-3-10"><a href="#lst:5-3-10"></a>        }</span>
<span id="lst:5-3-11"><a href="#lst:5-3-11"></a></span>
<span id="lst:5-3-12"><a href="#lst:5-3-12"></a>        <span class="kw">function</span> <span class="fu">buttonBPressed</span>() {</span>
<span id="lst:5-3-13"><a href="#lst:5-3-13"></a>            x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="lst:5-3-14"><a href="#lst:5-3-14"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;label1&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="lst:5-3-15"><a href="#lst:5-3-15"></a>        }</span>
<span id="lst:5-3-16"><a href="#lst:5-3-16"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:5-3-17"><a href="#lst:5-3-17"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:5-3-18"><a href="#lst:5-3-18"></a></span>
<span id="lst:5-3-19"><a href="#lst:5-3-19"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:5-3-20"><a href="#lst:5-3-20"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:5-3-21"><a href="#lst:5-3-21"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonBPressed()&quot;</span><span class="kw">&gt;</span>B<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:5-3-22"><a href="#lst:5-3-22"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:5-3-23"><a href="#lst:5-3-23"></a>    <span class="kw">&lt;p</span><span class="ot"> id=</span><span class="st">&quot;label1&quot;</span><span class="kw">&gt;</span>0<span class="kw">&lt;/p&gt;</span></span>
<span id="lst:5-3-24"><a href="#lst:5-3-24"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:5-3-25"><a href="#lst:5-3-25"></a></span>
<span id="lst:5-3-26"><a href="#lst:5-3-26"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/5-3.html" class="myiframe"></iframe>
</div>
<p>もう一つの関数を用意して，カウントをリセットするボタンを作ることができました．</p>
<h3 class="unnumbered" data-number="" id="tips-2">tips</h3>
<p>このように，大変便利に見えるグローバル変数ですが，プログラムの保守という観点からは問題が多いので，極力控えてプログラムを作ることが推奨されています．簡単に説明すると，バグが起こったときに，ローカル変数ならばバグの範囲が限定しやすいのですが，グローバル変数が多いと，影響を与える関数（プログラム）の範囲が広大になってしまい，デバッグする範囲も広域に及びます．</p>
<h1 data-number="6" id="canvas入門"><span class="header-section-number">6</span> canvas入門</h1>
<p>本章では，canvasの基本的な使い方を学びます．</p>
<h2 data-number="6.1" id="canvasをつくり四角形を書く"><span class="header-section-number">6.1</span> canvasをつくり，四角形を書く</h2>
<p>canvasタグ（要素）は，そこにJavascriptプログラムを使って図形や文字を書いたり，画像を描画することができるHTMLの要素です．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:6-1')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:6-1" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:6-1-1"><a href="#lst:6-1-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:6-1-2"><a href="#lst:6-1-2"></a></span>
<span id="lst:6-1-3"><a href="#lst:6-1-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:6-1-4"><a href="#lst:6-1-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:6-1-5"><a href="#lst:6-1-5"></a></span>
<span id="lst:6-1-6"><a href="#lst:6-1-6"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:6-1-7"><a href="#lst:6-1-7"></a>            <span class="kw">var</span> ctx <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;canvas1&#39;</span>)<span class="op">.</span><span class="fu">getContext</span>(<span class="st">&#39;2d&#39;</span>)<span class="op">;</span></span>
<span id="lst:6-1-8"><a href="#lst:6-1-8"></a>            ctx<span class="op">.</span><span class="fu">clearRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">400</span><span class="op">,</span> <span class="dv">300</span>)<span class="op">;</span></span>
<span id="lst:6-1-9"><a href="#lst:6-1-9"></a></span>
<span id="lst:6-1-10"><a href="#lst:6-1-10"></a>            ctx<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="st">&#39;#0000FF&#39;</span><span class="op">;</span></span>
<span id="lst:6-1-11"><a href="#lst:6-1-11"></a>            ctx<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="st">&#39;#FF0000&#39;</span><span class="op">;</span></span>
<span id="lst:6-1-12"><a href="#lst:6-1-12"></a></span>
<span id="lst:6-1-13"><a href="#lst:6-1-13"></a>            ctx<span class="op">.</span><span class="fu">strokeRect</span>(<span class="dv">200</span><span class="op">,</span> <span class="dv">80</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">50</span>)<span class="op">;</span></span>
<span id="lst:6-1-14"><a href="#lst:6-1-14"></a>            ctx<span class="op">.</span><span class="fu">fillRect</span>(<span class="dv">20</span><span class="op">,</span> <span class="dv">40</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">100</span>)<span class="op">;</span></span>
<span id="lst:6-1-15"><a href="#lst:6-1-15"></a>        }</span>
<span id="lst:6-1-16"><a href="#lst:6-1-16"></a></span>
<span id="lst:6-1-17"><a href="#lst:6-1-17"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:6-1-18"><a href="#lst:6-1-18"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:6-1-19"><a href="#lst:6-1-19"></a></span>
<span id="lst:6-1-20"><a href="#lst:6-1-20"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:6-1-21"><a href="#lst:6-1-21"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:6-1-22"><a href="#lst:6-1-22"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:6-1-23"><a href="#lst:6-1-23"></a>    <span class="kw">&lt;canvas</span><span class="ot"> id=</span><span class="st">&quot;canvas1&quot;</span><span class="ot"> width=</span><span class="st">&quot;400&quot;</span><span class="ot"> height=</span><span class="st">&quot;300&quot;</span><span class="ot"> style=</span><span class="st">&quot;border: solid 1px;&quot;</span><span class="kw">&gt;&lt;/canvas&gt;</span></span>
<span id="lst:6-1-24"><a href="#lst:6-1-24"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:6-1-25"><a href="#lst:6-1-25"></a></span>
<span id="lst:6-1-26"><a href="#lst:6-1-26"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/6-1.html" class="myiframe"></iframe>
</div>
<p>canvasタグで，キャンパスを作ります．大きさを指定し，Javascriptから読み書きできるようにidをつけ，見分けがつくようにボーダー線をつけます．</p>
<pre><code>&lt;canvas id=&quot;canvas1&quot; width=&quot;400&quot; height=&quot;300&quot; style=&quot;border: solid 1px;&quot;&gt;&lt;/canvas&gt;</code></pre>
<p>プログラムでは，１行目で，</p>
<pre><code>var ctx = document.getElementById(&#39;canvas1&#39;).getContext(&#39;2d&#39;);</code></pre>
<p>おなじみのgetElementById()関数を使い，idを指定して要素を取得し，2Dで書き込めるcontextオブジェクトを取得し，ctx変数に格納します．この行は，canvasに書き込むプログラムを作るときに毎回書くおまじないと思ってください．</p>
<p>次の行で，背景を塗りつぶします．前回になにか書いたものがあればこの行で消されます． ボタンが押されるたびにcanvasに追記していきたい場合はこの行を削除します．</p>
<pre><code>ctx.clearRect(0, 0, 400, 300);</code></pre>
<p>枠線と塗りつぶしの色を決めます．</p>
<pre><code>ctx.strokeStyle = &#39;#0000FF&#39;; //枠線の色は青
ctx.fillStyle = &#39;#FF0000&#39;; //塗りつぶしの色は赤</code></pre>
<p>strokeRect(x, y, w, h)関数は，x, y座標を基点に，幅w, 高さhの四角形を描画します．fillRectは塗りつぶしの四角形を描画します．</p>
<pre><code>ctx.strokeRect(200, 80, 100, 50);
ctx.fillRect(20, 40, 50, 100);</code></pre>
<h2 data-number="6.2" id="円を書く"><span class="header-section-number">6.2</span> 円を書く</h2>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:6-2')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:6-2" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:6-2-1"><a href="#lst:6-2-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:6-2-2"><a href="#lst:6-2-2"></a></span>
<span id="lst:6-2-3"><a href="#lst:6-2-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:6-2-4"><a href="#lst:6-2-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:6-2-5"><a href="#lst:6-2-5"></a></span>
<span id="lst:6-2-6"><a href="#lst:6-2-6"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:6-2-7"><a href="#lst:6-2-7"></a>            <span class="kw">var</span> ctx <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;canvas1&#39;</span>)<span class="op">.</span><span class="fu">getContext</span>(<span class="st">&#39;2d&#39;</span>)<span class="op">;</span></span>
<span id="lst:6-2-8"><a href="#lst:6-2-8"></a>            ctx<span class="op">.</span><span class="fu">clearRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">400</span><span class="op">,</span> <span class="dv">300</span>)<span class="op">;</span></span>
<span id="lst:6-2-9"><a href="#lst:6-2-9"></a></span>
<span id="lst:6-2-10"><a href="#lst:6-2-10"></a>            ctx<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="st">&#39;#0000FF&#39;</span><span class="op">;</span></span>
<span id="lst:6-2-11"><a href="#lst:6-2-11"></a>            ctx<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="st">&#39;#FF0000&#39;</span><span class="op">;</span></span>
<span id="lst:6-2-12"><a href="#lst:6-2-12"></a></span>
<span id="lst:6-2-13"><a href="#lst:6-2-13"></a>            ctx<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="lst:6-2-14"><a href="#lst:6-2-14"></a>            ctx<span class="op">.</span><span class="fu">arc</span>(<span class="dv">100</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">*</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="lst:6-2-15"><a href="#lst:6-2-15"></a>            ctx<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="lst:6-2-16"><a href="#lst:6-2-16"></a></span>
<span id="lst:6-2-17"><a href="#lst:6-2-17"></a>            ctx<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="lst:6-2-18"><a href="#lst:6-2-18"></a>            ctx<span class="op">.</span><span class="fu">arc</span>(<span class="dv">200</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">*</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="lst:6-2-19"><a href="#lst:6-2-19"></a>            ctx<span class="op">.</span><span class="fu">fill</span>()<span class="op">;</span></span>
<span id="lst:6-2-20"><a href="#lst:6-2-20"></a>        }</span>
<span id="lst:6-2-21"><a href="#lst:6-2-21"></a></span>
<span id="lst:6-2-22"><a href="#lst:6-2-22"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:6-2-23"><a href="#lst:6-2-23"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:6-2-24"><a href="#lst:6-2-24"></a></span>
<span id="lst:6-2-25"><a href="#lst:6-2-25"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:6-2-26"><a href="#lst:6-2-26"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:6-2-27"><a href="#lst:6-2-27"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:6-2-28"><a href="#lst:6-2-28"></a>    <span class="kw">&lt;canvas</span><span class="ot"> id=</span><span class="st">&quot;canvas1&quot;</span><span class="ot"> width=</span><span class="st">&quot;400&quot;</span><span class="ot"> height=</span><span class="st">&quot;300&quot;</span><span class="ot"> style=</span><span class="st">&quot;border: solid 1px;&quot;</span><span class="kw">&gt;&lt;/canvas&gt;</span></span>
<span id="lst:6-2-29"><a href="#lst:6-2-29"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:6-2-30"><a href="#lst:6-2-30"></a></span>
<span id="lst:6-2-31"><a href="#lst:6-2-31"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/6-2.html" class="myiframe"></iframe>
</div>
<p>円を書くには，まず，</p>
<pre><code>ctx.beginPath();</code></pre>
<p>でパス（図形を描画するとき一つ一つの動作でできる要素のことをパスと呼びます）を初期化します．</p>
<p>次に，</p>
<pre><code>ctx.arc(100, 100, 50, 0, Math.PI * 2);</code></pre>
<p>で，円弧を書きます．引数は(x, y, 半径, 開始角度(ラジアン), 終了角度(ラジアン))です．上記の例では，座標（100, 100）を中心に，半径50の円を書きます．</p>
<p>最後に，</p>
<pre><code>ctx.stroke();</code></pre>
<p>で，パスを終了し，図形を描画します．</p>
<p>円弧ではなく，塗りつぶすには</p>
<pre><code>ctx.fill();</code></pre>
<p>で，パスを終了し，図形を描画します．</p>
<h3 class="unnumbered" data-number="" id="hint-2">hint</h3>
<p>180°はラジアンでπ，360°はラジアンで２πとなります．</p>
<h2 data-number="6.3" id="線を書く"><span class="header-section-number">6.3</span> 線を書く</h2>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:6-3')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:6-3" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:6-3-1"><a href="#lst:6-3-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:6-3-2"><a href="#lst:6-3-2"></a></span>
<span id="lst:6-3-3"><a href="#lst:6-3-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:6-3-4"><a href="#lst:6-3-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:6-3-5"><a href="#lst:6-3-5"></a></span>
<span id="lst:6-3-6"><a href="#lst:6-3-6"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:6-3-7"><a href="#lst:6-3-7"></a>            <span class="kw">var</span> ctx <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;canvas1&#39;</span>)<span class="op">.</span><span class="fu">getContext</span>(<span class="st">&#39;2d&#39;</span>)<span class="op">;</span></span>
<span id="lst:6-3-8"><a href="#lst:6-3-8"></a>            ctx<span class="op">.</span><span class="fu">clearRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">400</span><span class="op">,</span> <span class="dv">300</span>)<span class="op">;</span></span>
<span id="lst:6-3-9"><a href="#lst:6-3-9"></a></span>
<span id="lst:6-3-10"><a href="#lst:6-3-10"></a>            ctx<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="st">&#39;#0000FF&#39;</span><span class="op">;</span></span>
<span id="lst:6-3-11"><a href="#lst:6-3-11"></a>            ctx<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="st">&#39;#FF0000&#39;</span><span class="op">;</span></span>
<span id="lst:6-3-12"><a href="#lst:6-3-12"></a></span>
<span id="lst:6-3-13"><a href="#lst:6-3-13"></a>            <span class="co">//100, 100から200, 200 へ線を引く</span></span>
<span id="lst:6-3-14"><a href="#lst:6-3-14"></a>            ctx<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="lst:6-3-15"><a href="#lst:6-3-15"></a>            ctx<span class="op">.</span><span class="fu">moveTo</span>(<span class="dv">100</span><span class="op">,</span> <span class="dv">100</span>)<span class="op">;</span></span>
<span id="lst:6-3-16"><a href="#lst:6-3-16"></a>            ctx<span class="op">.</span><span class="fu">lineTo</span>(<span class="dv">200</span><span class="op">,</span> <span class="dv">200</span>)<span class="op">;</span></span>
<span id="lst:6-3-17"><a href="#lst:6-3-17"></a>            ctx<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="lst:6-3-18"><a href="#lst:6-3-18"></a></span>
<span id="lst:6-3-19"><a href="#lst:6-3-19"></a>            <span class="co">//３点を頂点とする三角形を描画する</span></span>
<span id="lst:6-3-20"><a href="#lst:6-3-20"></a>            ctx<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="lst:6-3-21"><a href="#lst:6-3-21"></a>            ctx<span class="op">.</span><span class="fu">moveTo</span>(<span class="dv">200</span><span class="op">,</span> <span class="dv">200</span>)<span class="op">;</span></span>
<span id="lst:6-3-22"><a href="#lst:6-3-22"></a>            ctx<span class="op">.</span><span class="fu">lineTo</span>(<span class="dv">250</span><span class="op">,</span> <span class="dv">100</span>)<span class="op">;</span></span>
<span id="lst:6-3-23"><a href="#lst:6-3-23"></a>            ctx<span class="op">.</span><span class="fu">lineTo</span>(<span class="dv">300</span><span class="op">,</span> <span class="dv">200</span>)<span class="op">;</span></span>
<span id="lst:6-3-24"><a href="#lst:6-3-24"></a>            ctx<span class="op">.</span><span class="fu">closePath</span>()<span class="op">;</span></span>
<span id="lst:6-3-25"><a href="#lst:6-3-25"></a>            ctx<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="lst:6-3-26"><a href="#lst:6-3-26"></a>        }</span>
<span id="lst:6-3-27"><a href="#lst:6-3-27"></a></span>
<span id="lst:6-3-28"><a href="#lst:6-3-28"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:6-3-29"><a href="#lst:6-3-29"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:6-3-30"><a href="#lst:6-3-30"></a></span>
<span id="lst:6-3-31"><a href="#lst:6-3-31"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:6-3-32"><a href="#lst:6-3-32"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:6-3-33"><a href="#lst:6-3-33"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:6-3-34"><a href="#lst:6-3-34"></a>    <span class="kw">&lt;canvas</span><span class="ot"> id=</span><span class="st">&quot;canvas1&quot;</span><span class="ot"> width=</span><span class="st">&quot;400&quot;</span><span class="ot"> height=</span><span class="st">&quot;300&quot;</span><span class="ot"> style=</span><span class="st">&quot;border: solid 1px;&quot;</span><span class="kw">&gt;&lt;/canvas&gt;</span></span>
<span id="lst:6-3-35"><a href="#lst:6-3-35"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:6-3-36"><a href="#lst:6-3-36"></a></span>
<span id="lst:6-3-37"><a href="#lst:6-3-37"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/6-3.html" class="myiframe"></iframe>
</div>
<p>線を書くには，まずbeginPath();でパスを初期化し，</p>
<p>始点を</p>
<pre><code>ctx.moveTo(100, 100);</code></pre>
<p>で設定し，終点を</p>
<pre><code>ctx.lineTo(200, 200);</code></pre>
<p>で設定します．</p>
<p>最後に，</p>
<pre><code>ctx.stroke();</code></pre>
<p>で，パスを終了し，線を描画します．</p>
<p>lineToを２回以上呼び出して，３角形以上の多角形ができる場合には，始点と終点をつなぎ，多角形を作ります．</p>
<h2 data-number="6.4" id="文字列を描画する"><span class="header-section-number">6.4</span> 文字列を描画する</h2>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:6-4')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:6-4" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:6-4-1"><a href="#lst:6-4-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:6-4-2"><a href="#lst:6-4-2"></a></span>
<span id="lst:6-4-3"><a href="#lst:6-4-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:6-4-4"><a href="#lst:6-4-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:6-4-5"><a href="#lst:6-4-5"></a></span>
<span id="lst:6-4-6"><a href="#lst:6-4-6"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:6-4-7"><a href="#lst:6-4-7"></a>            <span class="kw">var</span> ctx <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;canvas1&#39;</span>)<span class="op">.</span><span class="fu">getContext</span>(<span class="st">&#39;2d&#39;</span>)<span class="op">;</span></span>
<span id="lst:6-4-8"><a href="#lst:6-4-8"></a>            ctx<span class="op">.</span><span class="fu">clearRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">400</span><span class="op">,</span> <span class="dv">300</span>)<span class="op">;</span></span>
<span id="lst:6-4-9"><a href="#lst:6-4-9"></a></span>
<span id="lst:6-4-10"><a href="#lst:6-4-10"></a>            ctx<span class="op">.</span><span class="at">font</span> <span class="op">=</span> <span class="st">&quot;30px sans-serif&quot;</span><span class="op">;</span></span>
<span id="lst:6-4-11"><a href="#lst:6-4-11"></a>            ctx<span class="op">.</span><span class="fu">fillText</span>(<span class="st">&quot;hello, world!&quot;</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">75</span><span class="op">,</span> <span class="dv">200</span>)<span class="op">;</span></span>
<span id="lst:6-4-12"><a href="#lst:6-4-12"></a>            ctx<span class="op">.</span><span class="fu">strokeText</span>(<span class="st">&quot;hello, world!&quot;</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">175</span><span class="op">,</span> <span class="dv">200</span>)<span class="op">;</span></span>
<span id="lst:6-4-13"><a href="#lst:6-4-13"></a>        }</span>
<span id="lst:6-4-14"><a href="#lst:6-4-14"></a></span>
<span id="lst:6-4-15"><a href="#lst:6-4-15"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:6-4-16"><a href="#lst:6-4-16"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:6-4-17"><a href="#lst:6-4-17"></a></span>
<span id="lst:6-4-18"><a href="#lst:6-4-18"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:6-4-19"><a href="#lst:6-4-19"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:6-4-20"><a href="#lst:6-4-20"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:6-4-21"><a href="#lst:6-4-21"></a>    <span class="kw">&lt;canvas</span><span class="ot"> id=</span><span class="st">&quot;canvas1&quot;</span><span class="ot"> width=</span><span class="st">&quot;400&quot;</span><span class="ot"> height=</span><span class="st">&quot;300&quot;</span><span class="ot"> style=</span><span class="st">&quot;border: solid 1px;&quot;</span><span class="kw">&gt;&lt;/canvas&gt;</span></span>
<span id="lst:6-4-22"><a href="#lst:6-4-22"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:6-4-23"><a href="#lst:6-4-23"></a></span>
<span id="lst:6-4-24"><a href="#lst:6-4-24"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/6-4.html" class="myiframe"></iframe>
</div>
<p>文字列を描画するには，</p>
<pre><code>ctx.font = &quot;30px sans-serif&quot;;</code></pre>
<p>で，フォントとその大きさを指定した後，</p>
<pre><code>ctx.fillText(&quot;hello, world!&quot;, 20, 75, 200);</code></pre>
<p>で，文字列を書き込みます．引数は(表示する文字列, x座標, y座標, 最大幅)です．</p>
<p>抜き文字を描画したい場合は，</p>
<pre><code>ctx.strokeText(&quot;hello, world!&quot;, 20, 175, 200);</code></pre>
<p>で描画します．</p>
<h2 data-number="6.5" id="画像を描画する"><span class="header-section-number">6.5</span> 画像を描画する</h2>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:6-5')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:6-5" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:6-5-1"><a href="#lst:6-5-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:6-5-2"><a href="#lst:6-5-2"></a></span>
<span id="lst:6-5-3"><a href="#lst:6-5-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:6-5-4"><a href="#lst:6-5-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:6-5-5"><a href="#lst:6-5-5"></a>        <span class="kw">var</span> img01 <span class="op">=</span> <span class="kw">new</span> Image()<span class="op">;</span></span>
<span id="lst:6-5-6"><a href="#lst:6-5-6"></a>        img01<span class="op">.</span><span class="at">src</span> <span class="op">=</span> <span class="st">&#39;goo.png&#39;</span><span class="op">;</span></span>
<span id="lst:6-5-7"><a href="#lst:6-5-7"></a></span>
<span id="lst:6-5-8"><a href="#lst:6-5-8"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:6-5-9"><a href="#lst:6-5-9"></a>            <span class="kw">var</span> ctx <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;canvas1&#39;</span>)<span class="op">.</span><span class="fu">getContext</span>(<span class="st">&#39;2d&#39;</span>)<span class="op">;</span></span>
<span id="lst:6-5-10"><a href="#lst:6-5-10"></a>            ctx<span class="op">.</span><span class="fu">clearRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">400</span><span class="op">,</span> <span class="dv">300</span>)<span class="op">;</span></span>
<span id="lst:6-5-11"><a href="#lst:6-5-11"></a></span>
<span id="lst:6-5-12"><a href="#lst:6-5-12"></a>            ctx<span class="op">.</span><span class="fu">drawImage</span>(img01<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">100</span>)<span class="op">;</span></span>
<span id="lst:6-5-13"><a href="#lst:6-5-13"></a>        }</span>
<span id="lst:6-5-14"><a href="#lst:6-5-14"></a></span>
<span id="lst:6-5-15"><a href="#lst:6-5-15"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:6-5-16"><a href="#lst:6-5-16"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:6-5-17"><a href="#lst:6-5-17"></a></span>
<span id="lst:6-5-18"><a href="#lst:6-5-18"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:6-5-19"><a href="#lst:6-5-19"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:6-5-20"><a href="#lst:6-5-20"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:6-5-21"><a href="#lst:6-5-21"></a>    <span class="kw">&lt;canvas</span><span class="ot"> id=</span><span class="st">&quot;canvas1&quot;</span><span class="ot"> width=</span><span class="st">&quot;400&quot;</span><span class="ot"> height=</span><span class="st">&quot;300&quot;</span><span class="ot"> style=</span><span class="st">&quot;border: solid 1px;&quot;</span><span class="kw">&gt;&lt;/canvas&gt;</span></span>
<span id="lst:6-5-22"><a href="#lst:6-5-22"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:6-5-23"><a href="#lst:6-5-23"></a></span>
<span id="lst:6-5-24"><a href="#lst:6-5-24"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/6-5.html" class="myiframe"></iframe>
</div>
<p>画像を描画するには，まず，グローバル変数として，画像オブジェクトを生成し，ファイル名を指定して画像を読み込みます． この書き方も，意味は完全にわからなくて構いませんので，最初はこう書くものだと覚えてください．</p>
<pre><code>var img01 = new Image();
img01.src = &quot;goo.png&quot;;</code></pre>
<p>読み込んだ画像をキャンパスに描くには，buttonAPressed関数内で，</p>
<pre><code>ctx.drawImage(img01, 10, 10, 100, 100);</code></pre>
<p>と記述し描画します．引数は(画像オブジェクト, x座標, y座標, 幅，高さ)です．</p>
<h1 data-number="7" id="canvas-応用編"><span class="header-section-number">7</span> canvas 応用編</h1>
<p>本章では，canvasを使った３つの応用プログラムを学びます．</p>
<h2 data-number="7.1" id="繰り返し図形"><span class="header-section-number">7.1</span> 繰り返し図形</h2>
<p>canvasを使ったdrawXXXなどという記述は，Javascriptプログラムですから，これまでに習った基礎的なプログラミングテクニック(for文，if文)が応用できます．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:7-1')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:7-1" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:7-1-1"><a href="#lst:7-1-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:7-1-2"><a href="#lst:7-1-2"></a></span>
<span id="lst:7-1-3"><a href="#lst:7-1-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:7-1-4"><a href="#lst:7-1-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:7-1-5"><a href="#lst:7-1-5"></a></span>
<span id="lst:7-1-6"><a href="#lst:7-1-6"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:7-1-7"><a href="#lst:7-1-7"></a>            <span class="kw">var</span> ctx <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;canvas1&#39;</span>)<span class="op">.</span><span class="fu">getContext</span>(<span class="st">&#39;2d&#39;</span>)<span class="op">;</span></span>
<span id="lst:7-1-8"><a href="#lst:7-1-8"></a>            ctx<span class="op">.</span><span class="fu">clearRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">400</span><span class="op">,</span> <span class="dv">300</span>)<span class="op">;</span></span>
<span id="lst:7-1-9"><a href="#lst:7-1-9"></a></span>
<span id="lst:7-1-10"><a href="#lst:7-1-10"></a>            <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">10</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="lst:7-1-11"><a href="#lst:7-1-11"></a>                ctx<span class="op">.</span><span class="fu">strokeRect</span>(i <span class="op">*</span> <span class="dv">15</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">10</span>)<span class="op">;</span></span>
<span id="lst:7-1-12"><a href="#lst:7-1-12"></a>            }</span>
<span id="lst:7-1-13"><a href="#lst:7-1-13"></a>        }</span>
<span id="lst:7-1-14"><a href="#lst:7-1-14"></a></span>
<span id="lst:7-1-15"><a href="#lst:7-1-15"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:7-1-16"><a href="#lst:7-1-16"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:7-1-17"><a href="#lst:7-1-17"></a></span>
<span id="lst:7-1-18"><a href="#lst:7-1-18"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:7-1-19"><a href="#lst:7-1-19"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:7-1-20"><a href="#lst:7-1-20"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:7-1-21"><a href="#lst:7-1-21"></a>    <span class="kw">&lt;canvas</span><span class="ot"> id=</span><span class="st">&quot;canvas1&quot;</span><span class="ot"> width=</span><span class="st">&quot;400&quot;</span><span class="ot"> height=</span><span class="st">&quot;300&quot;</span><span class="ot"> style=</span><span class="st">&quot;border: solid 1px;&quot;</span><span class="kw">&gt;&lt;/canvas&gt;</span></span>
<span id="lst:7-1-22"><a href="#lst:7-1-22"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:7-1-23"><a href="#lst:7-1-23"></a></span>
<span id="lst:7-1-24"><a href="#lst:7-1-24"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/7-1.html" class="myiframe"></iframe>
</div>
<p>上記のプログラムで，四角形を横に並べて１０個書くためには，x座標を工夫して</p>
<pre><code>for (var i = 0; i &lt; 10; i++) {
    ctx.strokeRect(i * 15, 50, 10, 10);
}</code></pre>
<p>というように書くと，繰り返しを使って多くの同様の図形を書くことができます．</p>
<h2 data-number="7.2" id="テキストフィールドと組み合わせる"><span class="header-section-number">7.2</span> テキストフィールドと組み合わせる</h2>
<p>canvasの外にあるテキストフィールドと組み合わせてプログラムを作ることもできます．</p>
<p>次のプログラムでは，テキストフィールドからx座標とy座標の入力を受け取り，その場所に四角形を描いています．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:7-2')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:7-2" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:7-2-1"><a href="#lst:7-2-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:7-2-2"><a href="#lst:7-2-2"></a></span>
<span id="lst:7-2-3"><a href="#lst:7-2-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:7-2-4"><a href="#lst:7-2-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:7-2-5"><a href="#lst:7-2-5"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:7-2-6"><a href="#lst:7-2-6"></a>            <span class="kw">var</span> ctx <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;canvas1&#39;</span>)<span class="op">.</span><span class="fu">getContext</span>(<span class="st">&#39;2d&#39;</span>)<span class="op">;</span></span>
<span id="lst:7-2-7"><a href="#lst:7-2-7"></a>            ctx<span class="op">.</span><span class="fu">clearRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">400</span><span class="op">,</span> <span class="dv">300</span>)<span class="op">;</span></span>
<span id="lst:7-2-8"><a href="#lst:7-2-8"></a></span>
<span id="lst:7-2-9"><a href="#lst:7-2-9"></a>            <span class="kw">var</span> x <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;x&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="lst:7-2-10"><a href="#lst:7-2-10"></a>            x <span class="op">=</span> <span class="bu">Number</span>(x)<span class="op">;</span></span>
<span id="lst:7-2-11"><a href="#lst:7-2-11"></a>            <span class="kw">var</span> y <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;y&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="lst:7-2-12"><a href="#lst:7-2-12"></a>            y <span class="op">=</span> <span class="bu">Number</span>(y)<span class="op">;</span></span>
<span id="lst:7-2-13"><a href="#lst:7-2-13"></a></span>
<span id="lst:7-2-14"><a href="#lst:7-2-14"></a>            ctx<span class="op">.</span><span class="fu">strokeRect</span>(x<span class="op">,</span> y<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">10</span>)<span class="op">;</span></span>
<span id="lst:7-2-15"><a href="#lst:7-2-15"></a>        }</span>
<span id="lst:7-2-16"><a href="#lst:7-2-16"></a></span>
<span id="lst:7-2-17"><a href="#lst:7-2-17"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:7-2-18"><a href="#lst:7-2-18"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:7-2-19"><a href="#lst:7-2-19"></a></span>
<span id="lst:7-2-20"><a href="#lst:7-2-20"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:7-2-21"><a href="#lst:7-2-21"></a>    X:<span class="kw">&lt;input</span><span class="ot"> id=</span><span class="st">&quot;x&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> value=</span><span class="st">&quot;0&quot;</span><span class="kw">&gt;</span>Y:<span class="kw">&lt;input</span><span class="ot"> id=</span><span class="st">&quot;y&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> value=</span><span class="st">&quot;0&quot;</span><span class="kw">&gt;</span></span>
<span id="lst:7-2-22"><a href="#lst:7-2-22"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:7-2-23"><a href="#lst:7-2-23"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:7-2-24"><a href="#lst:7-2-24"></a>    <span class="kw">&lt;canvas</span><span class="ot"> id=</span><span class="st">&quot;canvas1&quot;</span><span class="ot"> width=</span><span class="st">&quot;400&quot;</span><span class="ot"> height=</span><span class="st">&quot;300&quot;</span><span class="ot"> style=</span><span class="st">&quot;border: solid 1px;&quot;</span><span class="kw">&gt;&lt;/canvas&gt;</span></span>
<span id="lst:7-2-25"><a href="#lst:7-2-25"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:7-2-26"><a href="#lst:7-2-26"></a></span>
<span id="lst:7-2-27"><a href="#lst:7-2-27"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/7-2.html" class="myiframe"></iframe>
</div>
<h2 data-number="7.3" id="じゃんけんプログラム"><span class="header-section-number">7.3</span> じゃんけんプログラム</h2>
<p>canvasの画像描画を応用して，じゃんけんプログラムを作ってみましょう． グー，チョキ，パーの画像を用意して，乱数を使い，どの手を出すのかを決めて，その画像を表示します．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:7-3')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:7-3" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:7-3-1"><a href="#lst:7-3-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:7-3-2"><a href="#lst:7-3-2"></a></span>
<span id="lst:7-3-3"><a href="#lst:7-3-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:7-3-4"><a href="#lst:7-3-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:7-3-5"><a href="#lst:7-3-5"></a></span>
<span id="lst:7-3-6"><a href="#lst:7-3-6"></a>        <span class="kw">var</span> img01 <span class="op">=</span> <span class="kw">new</span> Image()<span class="op">;</span></span>
<span id="lst:7-3-7"><a href="#lst:7-3-7"></a>        img01<span class="op">.</span><span class="at">src</span> <span class="op">=</span> <span class="st">&#39;goo.png&#39;</span><span class="op">;</span></span>
<span id="lst:7-3-8"><a href="#lst:7-3-8"></a>        <span class="kw">var</span> img02 <span class="op">=</span> <span class="kw">new</span> Image()<span class="op">;</span></span>
<span id="lst:7-3-9"><a href="#lst:7-3-9"></a>        img02<span class="op">.</span><span class="at">src</span> <span class="op">=</span> <span class="st">&#39;choki.png&#39;</span><span class="op">;</span></span>
<span id="lst:7-3-10"><a href="#lst:7-3-10"></a>        <span class="kw">var</span> img03 <span class="op">=</span> <span class="kw">new</span> Image()<span class="op">;</span></span>
<span id="lst:7-3-11"><a href="#lst:7-3-11"></a>        img03<span class="op">.</span><span class="at">src</span> <span class="op">=</span> <span class="st">&#39;pa.png&#39;</span><span class="op">;</span></span>
<span id="lst:7-3-12"><a href="#lst:7-3-12"></a></span>
<span id="lst:7-3-13"><a href="#lst:7-3-13"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:7-3-14"><a href="#lst:7-3-14"></a>            <span class="kw">var</span> ctx <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;canvas1&#39;</span>)<span class="op">.</span><span class="fu">getContext</span>(<span class="st">&#39;2d&#39;</span>)<span class="op">;</span></span>
<span id="lst:7-3-15"><a href="#lst:7-3-15"></a>            ctx<span class="op">.</span><span class="fu">clearRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">400</span><span class="op">,</span> <span class="dv">300</span>)<span class="op">;</span></span>
<span id="lst:7-3-16"><a href="#lst:7-3-16"></a></span>
<span id="lst:7-3-17"><a href="#lst:7-3-17"></a>            <span class="kw">var</span> x <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> <span class="dv">3</span>) <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="lst:7-3-18"><a href="#lst:7-3-18"></a>            <span class="cf">if</span> (x <span class="op">==</span> <span class="dv">1</span>) {</span>
<span id="lst:7-3-19"><a href="#lst:7-3-19"></a>                ctx<span class="op">.</span><span class="fu">drawImage</span>(img01<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">100</span>)<span class="op">;</span></span>
<span id="lst:7-3-20"><a href="#lst:7-3-20"></a>            } <span class="cf">else</span> <span class="cf">if</span> (x <span class="op">==</span> <span class="dv">2</span>) {</span>
<span id="lst:7-3-21"><a href="#lst:7-3-21"></a>                ctx<span class="op">.</span><span class="fu">drawImage</span>(img02<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">100</span>)<span class="op">;</span></span>
<span id="lst:7-3-22"><a href="#lst:7-3-22"></a>            } <span class="cf">else</span> <span class="cf">if</span> (x <span class="op">==</span> <span class="dv">3</span>) {</span>
<span id="lst:7-3-23"><a href="#lst:7-3-23"></a>                ctx<span class="op">.</span><span class="fu">drawImage</span>(img03<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">100</span>)<span class="op">;</span></span>
<span id="lst:7-3-24"><a href="#lst:7-3-24"></a>            }</span>
<span id="lst:7-3-25"><a href="#lst:7-3-25"></a>        }</span>
<span id="lst:7-3-26"><a href="#lst:7-3-26"></a></span>
<span id="lst:7-3-27"><a href="#lst:7-3-27"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:7-3-28"><a href="#lst:7-3-28"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:7-3-29"><a href="#lst:7-3-29"></a></span>
<span id="lst:7-3-30"><a href="#lst:7-3-30"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:7-3-31"><a href="#lst:7-3-31"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:7-3-32"><a href="#lst:7-3-32"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:7-3-33"><a href="#lst:7-3-33"></a>    <span class="kw">&lt;canvas</span><span class="ot"> id=</span><span class="st">&quot;canvas1&quot;</span><span class="ot"> width=</span><span class="st">&quot;400&quot;</span><span class="ot"> height=</span><span class="st">&quot;300&quot;</span><span class="ot"> style=</span><span class="st">&quot;border: solid 1px;&quot;</span><span class="kw">&gt;&lt;/canvas&gt;</span></span>
<span id="lst:7-3-34"><a href="#lst:7-3-34"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:7-3-35"><a href="#lst:7-3-35"></a></span>
<span id="lst:7-3-36"><a href="#lst:7-3-36"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/7-3.html" class="myiframe"></iframe>
</div>
<!-- 
### files
- [goo.png](src/goo.png)
- [choki.png](src/choki.png)
- [pa.png](src/pa.png) -->
<h1 data-number="8" id="タイマー"><span class="header-section-number">8</span> タイマー</h1>
<p>本章では，タイマーの使い方を学びます．</p>
<h2 data-number="8.1" id="タイマーから一定間隔で関数を呼び出す"><span class="header-section-number">8.1</span> タイマーから一定間隔で関数を呼び出す</h2>
<p>これまでのプログラムを動作させるには，必ずユーザがなにか操作（ボタンを押すなど）をする必要がありましたが，キッチンタイマーなど，定期的に，自動的に動作するプログラムを作るときには，時を刻むタイマーが必要になります．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:8-1')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:8-1" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:8-1-1"><a href="#lst:8-1-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:8-1-2"><a href="#lst:8-1-2"></a></span>
<span id="lst:8-1-3"><a href="#lst:8-1-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:8-1-4"><a href="#lst:8-1-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:8-1-5"><a href="#lst:8-1-5"></a>        <span class="kw">var</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="lst:8-1-6"><a href="#lst:8-1-6"></a></span>
<span id="lst:8-1-7"><a href="#lst:8-1-7"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:8-1-8"><a href="#lst:8-1-8"></a>            <span class="pp">setInterval</span>(tick<span class="op">,</span> <span class="dv">1000</span>)<span class="op">;</span></span>
<span id="lst:8-1-9"><a href="#lst:8-1-9"></a>        }</span>
<span id="lst:8-1-10"><a href="#lst:8-1-10"></a></span>
<span id="lst:8-1-11"><a href="#lst:8-1-11"></a>        <span class="kw">function</span> <span class="fu">tick</span>() {</span>
<span id="lst:8-1-12"><a href="#lst:8-1-12"></a>            x <span class="op">=</span> x <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="lst:8-1-13"><a href="#lst:8-1-13"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;time&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="lst:8-1-14"><a href="#lst:8-1-14"></a>        }</span>
<span id="lst:8-1-15"><a href="#lst:8-1-15"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:8-1-16"><a href="#lst:8-1-16"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:8-1-17"><a href="#lst:8-1-17"></a></span>
<span id="lst:8-1-18"><a href="#lst:8-1-18"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:8-1-19"><a href="#lst:8-1-19"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:8-1-20"><a href="#lst:8-1-20"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:8-1-21"><a href="#lst:8-1-21"></a>    <span class="kw">&lt;p</span><span class="ot"> id=</span><span class="st">&quot;time&quot;</span><span class="kw">&gt;</span>0<span class="kw">&lt;/p&gt;</span></span>
<span id="lst:8-1-22"><a href="#lst:8-1-22"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:8-1-23"><a href="#lst:8-1-23"></a></span>
<span id="lst:8-1-24"><a href="#lst:8-1-24"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/8-1.html" class="myiframe"></iframe>
</div>
<p>Javascriptでは，setInterval関数でタイマーを起動します．</p>
<p>setIntervalの書法は，次の通りです．</p>
<pre><code>setInterval([関数名], [呼び出す間隔(ミリ秒)]);</code></pre>
<p>例えば，</p>
<pre><code>setInterval(tick, 1000);</code></pre>
<p>という行では，tickという関数（下に定義してありますね）を，1000ミリ秒ごと，つまり１秒毎に呼び出すタイマーを起動する，という意味になります．Aボタンを押すと，setInterval関数が実行され，タイマーが起動して１秒毎にtick関数が実行されるようになります．</p>
<h2 data-number="8.2" id="タイマーを停止する"><span class="header-section-number">8.2</span> タイマーを停止する</h2>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:8-2')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:8-2" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:8-2-1"><a href="#lst:8-2-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:8-2-2"><a href="#lst:8-2-2"></a></span>
<span id="lst:8-2-3"><a href="#lst:8-2-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:8-2-4"><a href="#lst:8-2-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:8-2-5"><a href="#lst:8-2-5"></a>        <span class="kw">var</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="lst:8-2-6"><a href="#lst:8-2-6"></a>        <span class="kw">var</span> timer<span class="op">;</span></span>
<span id="lst:8-2-7"><a href="#lst:8-2-7"></a></span>
<span id="lst:8-2-8"><a href="#lst:8-2-8"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:8-2-9"><a href="#lst:8-2-9"></a>            timer <span class="op">=</span> <span class="pp">setInterval</span>(tick<span class="op">,</span> <span class="dv">1000</span>)<span class="op">;</span></span>
<span id="lst:8-2-10"><a href="#lst:8-2-10"></a>        }</span>
<span id="lst:8-2-11"><a href="#lst:8-2-11"></a></span>
<span id="lst:8-2-12"><a href="#lst:8-2-12"></a>        <span class="kw">function</span> <span class="fu">buttonBPressed</span>() {</span>
<span id="lst:8-2-13"><a href="#lst:8-2-13"></a>            <span class="pp">clearInterval</span>(timer)<span class="op">;</span></span>
<span id="lst:8-2-14"><a href="#lst:8-2-14"></a>        }</span>
<span id="lst:8-2-15"><a href="#lst:8-2-15"></a></span>
<span id="lst:8-2-16"><a href="#lst:8-2-16"></a>        <span class="kw">function</span> <span class="fu">tick</span>() {</span>
<span id="lst:8-2-17"><a href="#lst:8-2-17"></a>            x <span class="op">=</span> x <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="lst:8-2-18"><a href="#lst:8-2-18"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;time&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="lst:8-2-19"><a href="#lst:8-2-19"></a>        }</span>
<span id="lst:8-2-20"><a href="#lst:8-2-20"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:8-2-21"><a href="#lst:8-2-21"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:8-2-22"><a href="#lst:8-2-22"></a></span>
<span id="lst:8-2-23"><a href="#lst:8-2-23"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:8-2-24"><a href="#lst:8-2-24"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:8-2-25"><a href="#lst:8-2-25"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonBPressed()&quot;</span><span class="kw">&gt;</span>B<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:8-2-26"><a href="#lst:8-2-26"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:8-2-27"><a href="#lst:8-2-27"></a>    <span class="kw">&lt;p</span><span class="ot"> id=</span><span class="st">&quot;time&quot;</span><span class="kw">&gt;</span>0<span class="kw">&lt;/p&gt;</span></span>
<span id="lst:8-2-28"><a href="#lst:8-2-28"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:8-2-29"><a href="#lst:8-2-29"></a></span>
<span id="lst:8-2-30"><a href="#lst:8-2-30"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/8-2.html" class="myiframe"></iframe>
</div>
<p>タイマーを停止するには，</p>
<pre><code>clearInterval([タイマー変数]);</code></pre>
<p>関数を呼び出します．タイマー変数を記憶しておく必要があるので，グローバル変数として，</p>
<pre><code>var timer;</code></pre>
<p>を定義し，タイマーが起動したときに，setInterval関数の戻り値として得られるタイマー変数を記憶しておき，</p>
<pre><code>timer = setInterval(tick, 1000);</code></pre>
<p>clearInterval関数でタイマーを停止します．</p>
<pre><code>clearInterval(timer);</code></pre>
<h2 data-number="8.3" id="タイマーの重複起動を回避する"><span class="header-section-number">8.3</span> タイマーの重複起動を回避する</h2>
<p>一つ前のプログラムでは，タイマーの起動と停止を行うことができるようになりましたが， 何どもAボタンを押すと，タイマーがたくさん起動してしまい，停止もできなくなります（変数は一つのため，最後に起動したものしか停止できない）．</p>
<p>タイマーの重複起動を回避するテクニックをはいくつかあるのですが，状態変数による場合分けのプログラムを作ってみましょう．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:8-3')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:8-3" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:8-3-1"><a href="#lst:8-3-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:8-3-2"><a href="#lst:8-3-2"></a></span>
<span id="lst:8-3-3"><a href="#lst:8-3-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:8-3-4"><a href="#lst:8-3-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:8-3-5"><a href="#lst:8-3-5"></a>        <span class="kw">var</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="lst:8-3-6"><a href="#lst:8-3-6"></a>        <span class="kw">var</span> timer<span class="op">;</span></span>
<span id="lst:8-3-7"><a href="#lst:8-3-7"></a>        <span class="kw">var</span> state <span class="op">=</span> <span class="st">&#39;停止中&#39;</span><span class="op">;</span></span>
<span id="lst:8-3-8"><a href="#lst:8-3-8"></a></span>
<span id="lst:8-3-9"><a href="#lst:8-3-9"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:8-3-10"><a href="#lst:8-3-10"></a>            <span class="cf">if</span> (state <span class="op">==</span> <span class="st">&#39;停止中&#39;</span>) {</span>
<span id="lst:8-3-11"><a href="#lst:8-3-11"></a>                timer <span class="op">=</span> <span class="pp">setInterval</span>(tick<span class="op">,</span> <span class="dv">1000</span>)<span class="op">;</span></span>
<span id="lst:8-3-12"><a href="#lst:8-3-12"></a>                state <span class="op">=</span> <span class="st">&#39;動作中&#39;</span><span class="op">;</span></span>
<span id="lst:8-3-13"><a href="#lst:8-3-13"></a>            }</span>
<span id="lst:8-3-14"><a href="#lst:8-3-14"></a>        }</span>
<span id="lst:8-3-15"><a href="#lst:8-3-15"></a></span>
<span id="lst:8-3-16"><a href="#lst:8-3-16"></a>        <span class="kw">function</span> <span class="fu">buttonBPressed</span>() {</span>
<span id="lst:8-3-17"><a href="#lst:8-3-17"></a>            <span class="cf">if</span> (state <span class="op">==</span> <span class="st">&#39;動作中&#39;</span>) {</span>
<span id="lst:8-3-18"><a href="#lst:8-3-18"></a>                <span class="pp">clearInterval</span>(timer)<span class="op">;</span></span>
<span id="lst:8-3-19"><a href="#lst:8-3-19"></a>                state <span class="op">=</span> <span class="st">&#39;停止中&#39;</span><span class="op">;</span></span>
<span id="lst:8-3-20"><a href="#lst:8-3-20"></a>            }</span>
<span id="lst:8-3-21"><a href="#lst:8-3-21"></a>        }</span>
<span id="lst:8-3-22"><a href="#lst:8-3-22"></a></span>
<span id="lst:8-3-23"><a href="#lst:8-3-23"></a>        <span class="kw">function</span> <span class="fu">tick</span>() {</span>
<span id="lst:8-3-24"><a href="#lst:8-3-24"></a>            x <span class="op">=</span> x <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="lst:8-3-25"><a href="#lst:8-3-25"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;time&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="lst:8-3-26"><a href="#lst:8-3-26"></a>        }</span>
<span id="lst:8-3-27"><a href="#lst:8-3-27"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:8-3-28"><a href="#lst:8-3-28"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:8-3-29"><a href="#lst:8-3-29"></a></span>
<span id="lst:8-3-30"><a href="#lst:8-3-30"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:8-3-31"><a href="#lst:8-3-31"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:8-3-32"><a href="#lst:8-3-32"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonBPressed()&quot;</span><span class="kw">&gt;</span>B<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:8-3-33"><a href="#lst:8-3-33"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:8-3-34"><a href="#lst:8-3-34"></a>    <span class="kw">&lt;p</span><span class="ot"> id=</span><span class="st">&quot;time&quot;</span><span class="kw">&gt;</span>0<span class="kw">&lt;/p&gt;</span></span>
<span id="lst:8-3-35"><a href="#lst:8-3-35"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:8-3-36"><a href="#lst:8-3-36"></a></span>
<span id="lst:8-3-37"><a href="#lst:8-3-37"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/8-3.html" class="myiframe"></iframe>
</div>
<p>‘停止中’, か’起動中’かを記憶しておく変数stateをグローバル変数として定義します.</p>
<pre><code>var state = &#39;停止中&#39;;</code></pre>
<p>buttonAPressed()関数は次のように書き換えます．</p>
<pre><code>if (state == &#39;停止中&#39;) {
    timer = setInterval(tick, 1000);
    state = &#39;動作中&#39;;
}</code></pre>
<p>このプログラムは，stateが「停止中」のときだけ，タイマーを起動し，起動したらstateを「動作中」に切り替えます．</p>
<p>buttonBPressed()関数は次のように書き換えます．</p>
<pre><code>function buttonBPressed() {
    if (state == &#39;動作中&#39;) {
        clearInterval(timer);
        state = &#39;停止中&#39;;
    }
}</code></pre>
<p>このプログラムは，stateが「動作中」のときだけ，タイマーを停止し，停止したらstateを「停止中」に切り替えます．</p>
<h2 data-number="8.4" id="シンプルなインターフェイスに"><span class="header-section-number">8.4</span> シンプルなインターフェイスに</h2>
<p>state変数で状態を管理できるようになると，ボタンは一つでも同様の機能を実現できることに気づきます． AボタンとBボタンの動作について，Aボタン一つでその状態ごとに動作を分岐するようにして，Aボタンを押すたびに停止と実行を切り替えるプログラムを作ることができます．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:8-4')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:8-4" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:8-4-1"><a href="#lst:8-4-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:8-4-2"><a href="#lst:8-4-2"></a></span>
<span id="lst:8-4-3"><a href="#lst:8-4-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:8-4-4"><a href="#lst:8-4-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:8-4-5"><a href="#lst:8-4-5"></a>        <span class="kw">var</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="lst:8-4-6"><a href="#lst:8-4-6"></a>        <span class="kw">var</span> timer<span class="op">;</span></span>
<span id="lst:8-4-7"><a href="#lst:8-4-7"></a>        <span class="kw">var</span> state <span class="op">=</span> <span class="st">&#39;停止中&#39;</span><span class="op">;</span></span>
<span id="lst:8-4-8"><a href="#lst:8-4-8"></a></span>
<span id="lst:8-4-9"><a href="#lst:8-4-9"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:8-4-10"><a href="#lst:8-4-10"></a>            <span class="cf">if</span> (state <span class="op">==</span> <span class="st">&#39;停止中&#39;</span>) {</span>
<span id="lst:8-4-11"><a href="#lst:8-4-11"></a>                timer <span class="op">=</span> <span class="pp">setInterval</span>(tick<span class="op">,</span> <span class="dv">1000</span>)<span class="op">;</span></span>
<span id="lst:8-4-12"><a href="#lst:8-4-12"></a>                state <span class="op">=</span> <span class="st">&#39;動作中&#39;</span><span class="op">;</span></span>
<span id="lst:8-4-13"><a href="#lst:8-4-13"></a>            } <span class="cf">else</span> <span class="cf">if</span> (state <span class="op">==</span> <span class="st">&#39;動作中&#39;</span>) {</span>
<span id="lst:8-4-14"><a href="#lst:8-4-14"></a>                <span class="pp">clearInterval</span>(timer)<span class="op">;</span></span>
<span id="lst:8-4-15"><a href="#lst:8-4-15"></a>                state <span class="op">=</span> <span class="st">&#39;停止中&#39;</span><span class="op">;</span></span>
<span id="lst:8-4-16"><a href="#lst:8-4-16"></a>            }</span>
<span id="lst:8-4-17"><a href="#lst:8-4-17"></a>        }</span>
<span id="lst:8-4-18"><a href="#lst:8-4-18"></a></span>
<span id="lst:8-4-19"><a href="#lst:8-4-19"></a>        <span class="kw">function</span> <span class="fu">tick</span>() {</span>
<span id="lst:8-4-20"><a href="#lst:8-4-20"></a>            x <span class="op">=</span> x <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="lst:8-4-21"><a href="#lst:8-4-21"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;time&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="lst:8-4-22"><a href="#lst:8-4-22"></a>        }</span>
<span id="lst:8-4-23"><a href="#lst:8-4-23"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:8-4-24"><a href="#lst:8-4-24"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:8-4-25"><a href="#lst:8-4-25"></a></span>
<span id="lst:8-4-26"><a href="#lst:8-4-26"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:8-4-27"><a href="#lst:8-4-27"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:8-4-28"><a href="#lst:8-4-28"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:8-4-29"><a href="#lst:8-4-29"></a>    <span class="kw">&lt;p</span><span class="ot"> id=</span><span class="st">&quot;time&quot;</span><span class="kw">&gt;</span>0<span class="kw">&lt;/p&gt;</span></span>
<span id="lst:8-4-30"><a href="#lst:8-4-30"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:8-4-31"><a href="#lst:8-4-31"></a></span>
<span id="lst:8-4-32"><a href="#lst:8-4-32"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/8-4.html" class="myiframe"></iframe>
</div>
<h2 data-number="8.5" id="ストップウォッチ"><span class="header-section-number">8.5</span> ストップウォッチ</h2>
<p>タイマーのプログラムを応用して，ストップウォッチを作ってみましょう． 1/10秒の位と1秒の二桁の変数を用意して，100ミリ秒ごとに1/10秒の位をカウントアップし，1/10秒のくらいが10になったら，繰り上がりを実現します．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:8-5')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:8-5" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:8-5-1"><a href="#lst:8-5-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:8-5-2"><a href="#lst:8-5-2"></a></span>
<span id="lst:8-5-3"><a href="#lst:8-5-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:8-5-4"><a href="#lst:8-5-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:8-5-5"><a href="#lst:8-5-5"></a>        <span class="kw">var</span> sec <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="lst:8-5-6"><a href="#lst:8-5-6"></a>        <span class="kw">var</span> oneof10sec <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="lst:8-5-7"><a href="#lst:8-5-7"></a>        <span class="kw">var</span> timer<span class="op">;</span></span>
<span id="lst:8-5-8"><a href="#lst:8-5-8"></a>        <span class="kw">var</span> state <span class="op">=</span> <span class="st">&#39;停止中&#39;</span><span class="op">;</span></span>
<span id="lst:8-5-9"><a href="#lst:8-5-9"></a></span>
<span id="lst:8-5-10"><a href="#lst:8-5-10"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:8-5-11"><a href="#lst:8-5-11"></a>            <span class="cf">if</span> (state <span class="op">==</span> <span class="st">&#39;停止中&#39;</span>) {</span>
<span id="lst:8-5-12"><a href="#lst:8-5-12"></a>                timer <span class="op">=</span> <span class="pp">setInterval</span>(tick<span class="op">,</span> <span class="dv">100</span>)<span class="op">;</span></span>
<span id="lst:8-5-13"><a href="#lst:8-5-13"></a>                state <span class="op">=</span> <span class="st">&#39;動作中&#39;</span><span class="op">;</span></span>
<span id="lst:8-5-14"><a href="#lst:8-5-14"></a>            } <span class="cf">else</span> <span class="cf">if</span> (state <span class="op">==</span> <span class="st">&#39;動作中&#39;</span>) {</span>
<span id="lst:8-5-15"><a href="#lst:8-5-15"></a>                <span class="pp">clearInterval</span>(timer)<span class="op">;</span></span>
<span id="lst:8-5-16"><a href="#lst:8-5-16"></a>                state <span class="op">=</span> <span class="st">&#39;停止中&#39;</span><span class="op">;</span></span>
<span id="lst:8-5-17"><a href="#lst:8-5-17"></a>            }</span>
<span id="lst:8-5-18"><a href="#lst:8-5-18"></a>        }</span>
<span id="lst:8-5-19"><a href="#lst:8-5-19"></a></span>
<span id="lst:8-5-20"><a href="#lst:8-5-20"></a>        <span class="kw">function</span> <span class="fu">tick</span>() {</span>
<span id="lst:8-5-21"><a href="#lst:8-5-21"></a>            oneof10sec <span class="op">=</span> oneof10sec <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="lst:8-5-22"><a href="#lst:8-5-22"></a>            <span class="cf">if</span> (oneof10sec <span class="op">==</span> <span class="dv">10</span>) {</span>
<span id="lst:8-5-23"><a href="#lst:8-5-23"></a>                sec <span class="op">=</span> sec <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="lst:8-5-24"><a href="#lst:8-5-24"></a>                oneof10sec <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="lst:8-5-25"><a href="#lst:8-5-25"></a>            }</span>
<span id="lst:8-5-26"><a href="#lst:8-5-26"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;output-sec&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> sec<span class="op">;</span></span>
<span id="lst:8-5-27"><a href="#lst:8-5-27"></a>            <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;output-oneof10sec&#39;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> oneof10sec<span class="op">;</span></span>
<span id="lst:8-5-28"><a href="#lst:8-5-28"></a>        }</span>
<span id="lst:8-5-29"><a href="#lst:8-5-29"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:8-5-30"><a href="#lst:8-5-30"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:8-5-31"><a href="#lst:8-5-31"></a></span>
<span id="lst:8-5-32"><a href="#lst:8-5-32"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:8-5-33"><a href="#lst:8-5-33"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:8-5-34"><a href="#lst:8-5-34"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:8-5-35"><a href="#lst:8-5-35"></a>    <span class="kw">&lt;p&gt;&lt;span</span><span class="ot"> id=</span><span class="st">&quot;output-sec&quot;</span><span class="kw">&gt;</span>0<span class="kw">&lt;/span&gt;</span>:<span class="kw">&lt;span</span><span class="ot"> id=</span><span class="st">&quot;output-oneof10sec&quot;</span><span class="kw">&gt;</span>0<span class="kw">&lt;/span&gt;&lt;/p&gt;</span></span>
<span id="lst:8-5-36"><a href="#lst:8-5-36"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:8-5-37"><a href="#lst:8-5-37"></a></span>
<span id="lst:8-5-38"><a href="#lst:8-5-38"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/8-5.html" class="myiframe"></iframe>
</div>
<p>tick()関数の次のプログラムに注目しましょう．</p>
<pre><code>oneof10sec = oneof10sec + 1;
if (oneof10sec == 10) {
    sec = sec + 1;
    oneof10sec = 0;
}</code></pre>
<h1 data-number="9" id="タイマーとcanvasを使ったアニメーションの作成"><span class="header-section-number">9</span> タイマーとcanvasを使ったアニメーションの作成</h1>
<p>本章では，タイマーとcanvasを使って図形を動かすアニメーションを作成する方法を学びます．</p>
<h2 data-number="9.1" id="四角形を動かすアニメーション"><span class="header-section-number">9.1</span> 四角形を動かすアニメーション</h2>
<p>タイマーとcanvasを使って，図形を動かすアニメーションを作ることができます． tick()関数は，20ミリ秒ごとに呼ばれる関数で，この中で，毎回キャンパスを書き換えます． 毎回，少しずつ図形を動かしながら書くことで，物体が動いているように見えるアニメーションを作ることができます．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:9-1')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:9-1" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:9-1-1"><a href="#lst:9-1-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:9-1-2"><a href="#lst:9-1-2"></a></span>
<span id="lst:9-1-3"><a href="#lst:9-1-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:9-1-4"><a href="#lst:9-1-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:9-1-5"><a href="#lst:9-1-5"></a>        <span class="kw">var</span> timer<span class="op">;</span></span>
<span id="lst:9-1-6"><a href="#lst:9-1-6"></a>        <span class="kw">var</span> state <span class="op">=</span> <span class="st">&#39;停止中&#39;</span><span class="op">;</span></span>
<span id="lst:9-1-7"><a href="#lst:9-1-7"></a></span>
<span id="lst:9-1-8"><a href="#lst:9-1-8"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:9-1-9"><a href="#lst:9-1-9"></a>            <span class="cf">if</span> (state <span class="op">==</span> <span class="st">&#39;停止中&#39;</span>) {</span>
<span id="lst:9-1-10"><a href="#lst:9-1-10"></a>                timer <span class="op">=</span> <span class="pp">setInterval</span>(tick<span class="op">,</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="lst:9-1-11"><a href="#lst:9-1-11"></a>                state <span class="op">=</span> <span class="st">&#39;動作中&#39;</span><span class="op">;</span></span>
<span id="lst:9-1-12"><a href="#lst:9-1-12"></a>            } <span class="cf">else</span> <span class="cf">if</span> (state <span class="op">==</span> <span class="st">&#39;動作中&#39;</span>) {</span>
<span id="lst:9-1-13"><a href="#lst:9-1-13"></a>                <span class="pp">clearInterval</span>(timer)<span class="op">;</span></span>
<span id="lst:9-1-14"><a href="#lst:9-1-14"></a>                state <span class="op">=</span> <span class="st">&#39;停止中&#39;</span><span class="op">;</span></span>
<span id="lst:9-1-15"><a href="#lst:9-1-15"></a>            }</span>
<span id="lst:9-1-16"><a href="#lst:9-1-16"></a>        }</span>
<span id="lst:9-1-17"><a href="#lst:9-1-17"></a></span>
<span id="lst:9-1-18"><a href="#lst:9-1-18"></a>        <span class="kw">var</span> x <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="lst:9-1-19"><a href="#lst:9-1-19"></a>        <span class="kw">var</span> y <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="lst:9-1-20"><a href="#lst:9-1-20"></a></span>
<span id="lst:9-1-21"><a href="#lst:9-1-21"></a>        <span class="kw">function</span> <span class="fu">tick</span>() {</span>
<span id="lst:9-1-22"><a href="#lst:9-1-22"></a>            <span class="kw">var</span> ctx <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;canvas1&#39;</span>)<span class="op">.</span><span class="fu">getContext</span>(<span class="st">&#39;2d&#39;</span>)<span class="op">;</span></span>
<span id="lst:9-1-23"><a href="#lst:9-1-23"></a>            ctx<span class="op">.</span><span class="fu">clearRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">400</span><span class="op">,</span> <span class="dv">300</span>)<span class="op">;</span></span>
<span id="lst:9-1-24"><a href="#lst:9-1-24"></a></span>
<span id="lst:9-1-25"><a href="#lst:9-1-25"></a>            x <span class="op">=</span> x <span class="op">+</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="lst:9-1-26"><a href="#lst:9-1-26"></a>            ctx<span class="op">.</span><span class="fu">strokeRect</span>(x<span class="op">,</span> y<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">10</span>)<span class="op">;</span></span>
<span id="lst:9-1-27"><a href="#lst:9-1-27"></a>        }</span>
<span id="lst:9-1-28"><a href="#lst:9-1-28"></a></span>
<span id="lst:9-1-29"><a href="#lst:9-1-29"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:9-1-30"><a href="#lst:9-1-30"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:9-1-31"><a href="#lst:9-1-31"></a></span>
<span id="lst:9-1-32"><a href="#lst:9-1-32"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:9-1-33"><a href="#lst:9-1-33"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:9-1-34"><a href="#lst:9-1-34"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:9-1-35"><a href="#lst:9-1-35"></a>    <span class="kw">&lt;canvas</span><span class="ot"> id=</span><span class="st">&quot;canvas1&quot;</span><span class="ot"> width=</span><span class="st">&quot;400&quot;</span><span class="ot"> height=</span><span class="st">&quot;300&quot;</span><span class="ot"> style=</span><span class="st">&quot;border: solid 1px;&quot;</span><span class="kw">&gt;&lt;/canvas&gt;</span></span>
<span id="lst:9-1-36"><a href="#lst:9-1-36"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:9-1-37"><a href="#lst:9-1-37"></a></span>
<span id="lst:9-1-38"><a href="#lst:9-1-38"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/9-1.html" class="myiframe"></iframe>
</div>
<p>アニメーションを作るには，物体の位置を記憶しておく必要があるため，座標を記憶するグローバル変数を作成します．</p>
<pre><code>var x = 10;
var y = 10;</code></pre>
<p>20ミリ秒ごとに実行されるtick()関数では，毎回</p>
<pre><code>x = x + 2;</code></pre>
<p>というプログラムでxを2増やした後</p>
<pre><code>ctx.strokeRect(x, y, 10, 10);</code></pre>
<p>で，増やされたx変数の値を使ってx座標の位置に四角形を記述します．結果的に毎回，2ピクセルずつx座標を右に動かして描画します．これをタイマーで繰り返すと，物体が右に動いているように見えます．</p>
<h2 data-number="9.2" id="四角形を動かすアニメーションキャンパス外に出てしまった場合の処理"><span class="header-section-number">9.2</span> 四角形を動かすアニメーション（キャンパス外に出てしまった場合の処理）</h2>
<p>先のプログラムでは，四角形は右に動いていきますが，やがてキャンパス右外に出てしまいます． キャンパス右橋と左端をつないで，右外に出た場合には左から入ってくるようにしてみましょう．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:9-2')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:9-2" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:9-2-1"><a href="#lst:9-2-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:9-2-2"><a href="#lst:9-2-2"></a></span>
<span id="lst:9-2-3"><a href="#lst:9-2-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:9-2-4"><a href="#lst:9-2-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:9-2-5"><a href="#lst:9-2-5"></a>        <span class="kw">var</span> timer<span class="op">;</span></span>
<span id="lst:9-2-6"><a href="#lst:9-2-6"></a>        <span class="kw">var</span> state <span class="op">=</span> <span class="st">&#39;停止中&#39;</span><span class="op">;</span></span>
<span id="lst:9-2-7"><a href="#lst:9-2-7"></a></span>
<span id="lst:9-2-8"><a href="#lst:9-2-8"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:9-2-9"><a href="#lst:9-2-9"></a>            <span class="cf">if</span> (state <span class="op">==</span> <span class="st">&#39;停止中&#39;</span>) {</span>
<span id="lst:9-2-10"><a href="#lst:9-2-10"></a>                timer <span class="op">=</span> <span class="pp">setInterval</span>(tick<span class="op">,</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="lst:9-2-11"><a href="#lst:9-2-11"></a>                state <span class="op">=</span> <span class="st">&#39;動作中&#39;</span><span class="op">;</span></span>
<span id="lst:9-2-12"><a href="#lst:9-2-12"></a>            } <span class="cf">else</span> <span class="cf">if</span> (state <span class="op">==</span> <span class="st">&#39;動作中&#39;</span>) {</span>
<span id="lst:9-2-13"><a href="#lst:9-2-13"></a>                <span class="pp">clearInterval</span>(timer)<span class="op">;</span></span>
<span id="lst:9-2-14"><a href="#lst:9-2-14"></a>                state <span class="op">=</span> <span class="st">&#39;停止中&#39;</span><span class="op">;</span></span>
<span id="lst:9-2-15"><a href="#lst:9-2-15"></a>            }</span>
<span id="lst:9-2-16"><a href="#lst:9-2-16"></a>        }</span>
<span id="lst:9-2-17"><a href="#lst:9-2-17"></a></span>
<span id="lst:9-2-18"><a href="#lst:9-2-18"></a>        <span class="kw">var</span> x <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="lst:9-2-19"><a href="#lst:9-2-19"></a>        <span class="kw">var</span> y <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="lst:9-2-20"><a href="#lst:9-2-20"></a></span>
<span id="lst:9-2-21"><a href="#lst:9-2-21"></a>        <span class="kw">function</span> <span class="fu">tick</span>() {</span>
<span id="lst:9-2-22"><a href="#lst:9-2-22"></a>            <span class="kw">var</span> ctx <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;canvas1&#39;</span>)<span class="op">.</span><span class="fu">getContext</span>(<span class="st">&#39;2d&#39;</span>)<span class="op">;</span></span>
<span id="lst:9-2-23"><a href="#lst:9-2-23"></a>            ctx<span class="op">.</span><span class="fu">clearRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">400</span><span class="op">,</span> <span class="dv">300</span>)<span class="op">;</span></span>
<span id="lst:9-2-24"><a href="#lst:9-2-24"></a></span>
<span id="lst:9-2-25"><a href="#lst:9-2-25"></a>            x <span class="op">=</span> x <span class="op">+</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="lst:9-2-26"><a href="#lst:9-2-26"></a>            <span class="cf">if</span> (x <span class="op">&gt;</span> <span class="dv">400</span>) {</span>
<span id="lst:9-2-27"><a href="#lst:9-2-27"></a>                x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="lst:9-2-28"><a href="#lst:9-2-28"></a>            }</span>
<span id="lst:9-2-29"><a href="#lst:9-2-29"></a>            ctx<span class="op">.</span><span class="fu">strokeRect</span>(x<span class="op">,</span> y<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">10</span>)<span class="op">;</span></span>
<span id="lst:9-2-30"><a href="#lst:9-2-30"></a>        }</span>
<span id="lst:9-2-31"><a href="#lst:9-2-31"></a></span>
<span id="lst:9-2-32"><a href="#lst:9-2-32"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:9-2-33"><a href="#lst:9-2-33"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:9-2-34"><a href="#lst:9-2-34"></a></span>
<span id="lst:9-2-35"><a href="#lst:9-2-35"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:9-2-36"><a href="#lst:9-2-36"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:9-2-37"><a href="#lst:9-2-37"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:9-2-38"><a href="#lst:9-2-38"></a>    <span class="kw">&lt;canvas</span><span class="ot"> id=</span><span class="st">&quot;canvas1&quot;</span><span class="ot"> width=</span><span class="st">&quot;400&quot;</span><span class="ot"> height=</span><span class="st">&quot;300&quot;</span><span class="ot"> style=</span><span class="st">&quot;border: solid 1px;&quot;</span><span class="kw">&gt;&lt;/canvas&gt;</span></span>
<span id="lst:9-2-39"><a href="#lst:9-2-39"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:9-2-40"><a href="#lst:9-2-40"></a></span>
<span id="lst:9-2-41"><a href="#lst:9-2-41"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/9-2.html" class="myiframe"></iframe>
</div>
<p>tick()関数で，x座標を増やしたときに，x座標がキャンバスサイズ(今回は400)より大きい場合を調べて，大きくなった場合にはx座標を0に戻すプログラムを次のように書きます．</p>
<pre><code>if (x &gt; 400) {
    x = 0;
}</code></pre>
<h2 data-number="9.3" id="パラパラ漫画アニメーション"><span class="header-section-number">9.3</span> パラパラ漫画アニメーション</h2>
<p>タイマーを利用して，画像を次々と書き換えることもできます．これによってパラパラ漫画の要領でアニメーションを作ることができます．このプログラム例はじゃんけんのグー，チョキ，パーを切り替えるアニメーションです．</p>
<div class="mytable">
<p class="mytdhl">source <span class="CopyButton" onclick="copycode('lst:9-3')">c</span></p>
<p class="mytdhr">result</p>
</div>
<div class="mytable">
<div class="mytdl">
<div class="sourceCode" id="lst:9-3" data-caption=""><pre class="sourceCode numberSource numberLines html"><code class="sourceCode html"><span id="lst:9-3-1"><a href="#lst:9-3-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="lst:9-3-2"><a href="#lst:9-3-2"></a></span>
<span id="lst:9-3-3"><a href="#lst:9-3-3"></a><span class="kw">&lt;head&gt;</span></span>
<span id="lst:9-3-4"><a href="#lst:9-3-4"></a>    <span class="kw">&lt;script&gt;</span></span>
<span id="lst:9-3-5"><a href="#lst:9-3-5"></a></span>
<span id="lst:9-3-6"><a href="#lst:9-3-6"></a>        <span class="kw">var</span> img01 <span class="op">=</span> <span class="kw">new</span> Image()<span class="op">;</span></span>
<span id="lst:9-3-7"><a href="#lst:9-3-7"></a>        img01<span class="op">.</span><span class="at">src</span> <span class="op">=</span> <span class="st">&#39;goo.png&#39;</span><span class="op">;</span></span>
<span id="lst:9-3-8"><a href="#lst:9-3-8"></a>        <span class="kw">var</span> img02 <span class="op">=</span> <span class="kw">new</span> Image()<span class="op">;</span></span>
<span id="lst:9-3-9"><a href="#lst:9-3-9"></a>        img02<span class="op">.</span><span class="at">src</span> <span class="op">=</span> <span class="st">&#39;choki.png&#39;</span><span class="op">;</span></span>
<span id="lst:9-3-10"><a href="#lst:9-3-10"></a>        <span class="kw">var</span> img03 <span class="op">=</span> <span class="kw">new</span> Image()<span class="op">;</span></span>
<span id="lst:9-3-11"><a href="#lst:9-3-11"></a>        img03<span class="op">.</span><span class="at">src</span> <span class="op">=</span> <span class="st">&#39;pa.png&#39;</span><span class="op">;</span></span>
<span id="lst:9-3-12"><a href="#lst:9-3-12"></a></span>
<span id="lst:9-3-13"><a href="#lst:9-3-13"></a>        <span class="kw">var</span> timer<span class="op">;</span></span>
<span id="lst:9-3-14"><a href="#lst:9-3-14"></a>        <span class="kw">var</span> state <span class="op">=</span> <span class="st">&#39;停止中&#39;</span><span class="op">;</span></span>
<span id="lst:9-3-15"><a href="#lst:9-3-15"></a></span>
<span id="lst:9-3-16"><a href="#lst:9-3-16"></a>        <span class="kw">var</span> x <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="lst:9-3-17"><a href="#lst:9-3-17"></a></span>
<span id="lst:9-3-18"><a href="#lst:9-3-18"></a>        <span class="kw">function</span> <span class="fu">buttonAPressed</span>() {</span>
<span id="lst:9-3-19"><a href="#lst:9-3-19"></a>            <span class="cf">if</span> (state <span class="op">==</span> <span class="st">&#39;停止中&#39;</span>) {</span>
<span id="lst:9-3-20"><a href="#lst:9-3-20"></a>                timer <span class="op">=</span> <span class="pp">setInterval</span>(tick<span class="op">,</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="lst:9-3-21"><a href="#lst:9-3-21"></a>                state <span class="op">=</span> <span class="st">&#39;動作中&#39;</span><span class="op">;</span></span>
<span id="lst:9-3-22"><a href="#lst:9-3-22"></a>            } <span class="cf">else</span> <span class="cf">if</span> (state <span class="op">==</span> <span class="st">&#39;動作中&#39;</span>) {</span>
<span id="lst:9-3-23"><a href="#lst:9-3-23"></a>                <span class="pp">clearInterval</span>(timer)<span class="op">;</span></span>
<span id="lst:9-3-24"><a href="#lst:9-3-24"></a>                state <span class="op">=</span> <span class="st">&#39;停止中&#39;</span><span class="op">;</span></span>
<span id="lst:9-3-25"><a href="#lst:9-3-25"></a>            }</span>
<span id="lst:9-3-26"><a href="#lst:9-3-26"></a>        }</span>
<span id="lst:9-3-27"><a href="#lst:9-3-27"></a></span>
<span id="lst:9-3-28"><a href="#lst:9-3-28"></a>        <span class="kw">function</span> <span class="fu">tick</span>() {</span>
<span id="lst:9-3-29"><a href="#lst:9-3-29"></a>            <span class="kw">var</span> ctx <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;canvas1&#39;</span>)<span class="op">.</span><span class="fu">getContext</span>(<span class="st">&#39;2d&#39;</span>)<span class="op">;</span></span>
<span id="lst:9-3-30"><a href="#lst:9-3-30"></a>            ctx<span class="op">.</span><span class="fu">clearRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">400</span><span class="op">,</span> <span class="dv">300</span>)<span class="op">;</span></span>
<span id="lst:9-3-31"><a href="#lst:9-3-31"></a></span>
<span id="lst:9-3-32"><a href="#lst:9-3-32"></a>            <span class="cf">if</span> (x <span class="op">==</span> <span class="dv">1</span>) {</span>
<span id="lst:9-3-33"><a href="#lst:9-3-33"></a>                ctx<span class="op">.</span><span class="fu">drawImage</span>(img01<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">100</span>)<span class="op">;</span></span>
<span id="lst:9-3-34"><a href="#lst:9-3-34"></a>            } <span class="cf">else</span> <span class="cf">if</span> (x <span class="op">==</span> <span class="dv">2</span>) {</span>
<span id="lst:9-3-35"><a href="#lst:9-3-35"></a>                ctx<span class="op">.</span><span class="fu">drawImage</span>(img02<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">100</span>)<span class="op">;</span></span>
<span id="lst:9-3-36"><a href="#lst:9-3-36"></a>            } <span class="cf">else</span> <span class="cf">if</span> (x <span class="op">==</span> <span class="dv">3</span>) {</span>
<span id="lst:9-3-37"><a href="#lst:9-3-37"></a>                ctx<span class="op">.</span><span class="fu">drawImage</span>(img03<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">100</span>)<span class="op">;</span></span>
<span id="lst:9-3-38"><a href="#lst:9-3-38"></a>            }</span>
<span id="lst:9-3-39"><a href="#lst:9-3-39"></a></span>
<span id="lst:9-3-40"><a href="#lst:9-3-40"></a>            <span class="cf">if</span> (x <span class="op">&lt;=</span> <span class="dv">2</span>) {</span>
<span id="lst:9-3-41"><a href="#lst:9-3-41"></a>                x <span class="op">=</span> x <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="lst:9-3-42"><a href="#lst:9-3-42"></a>            } <span class="cf">else</span> {</span>
<span id="lst:9-3-43"><a href="#lst:9-3-43"></a>                x <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="lst:9-3-44"><a href="#lst:9-3-44"></a>            }</span>
<span id="lst:9-3-45"><a href="#lst:9-3-45"></a>        }</span>
<span id="lst:9-3-46"><a href="#lst:9-3-46"></a></span>
<span id="lst:9-3-47"><a href="#lst:9-3-47"></a>    <span class="kw">&lt;/script&gt;</span></span>
<span id="lst:9-3-48"><a href="#lst:9-3-48"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="lst:9-3-49"><a href="#lst:9-3-49"></a></span>
<span id="lst:9-3-50"><a href="#lst:9-3-50"></a><span class="kw">&lt;body&gt;</span></span>
<span id="lst:9-3-51"><a href="#lst:9-3-51"></a>    <span class="kw">&lt;button</span><span class="ot"> onclick=</span><span class="st">&quot;buttonAPressed()&quot;</span><span class="kw">&gt;</span>A<span class="kw">&lt;/button&gt;</span></span>
<span id="lst:9-3-52"><a href="#lst:9-3-52"></a>    <span class="kw">&lt;hr&gt;</span></span>
<span id="lst:9-3-53"><a href="#lst:9-3-53"></a>    <span class="kw">&lt;canvas</span><span class="ot"> id=</span><span class="st">&quot;canvas1&quot;</span><span class="ot"> width=</span><span class="st">&quot;400&quot;</span><span class="ot"> height=</span><span class="st">&quot;300&quot;</span><span class="ot"> style=</span><span class="st">&quot;border: solid 1px;&quot;</span><span class="kw">&gt;&lt;/canvas&gt;</span></span>
<span id="lst:9-3-54"><a href="#lst:9-3-54"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="lst:9-3-55"><a href="#lst:9-3-55"></a></span>
<span id="lst:9-3-56"><a href="#lst:9-3-56"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<iframe class="mytdr" src="src/9-3.html" class="myiframe"></iframe>
</div>
<p>現在の画像番号を保持する変数xをグローバル変数に定義します．</p>
<pre><code>var x = 1;</code></pre>
<p>3枚の画像があるため，変数は1, 2, 3と書き換えるようにします．</p>
<pre><code>if (x &lt;= 2) {
    x = x + 1;
} else {
    x = 1;
}</code></pre>
</body>
</html>
